' visual basic for applications procedure wrapper generated by generated by apiwrapper for gams version 24.0.2


public const optdatanone    = 0  'optdatatype
public const optdatainteger = 1  'optdatatype
public const optdatadouble  = 2  'optdatatype
public const optdatastring  = 3  'optdatatype
public const optdatastrlist = 4  'optdatatype

public const opttypeinteger   = 0  'optoptiontype
public const opttypedouble    = 1  'optoptiontype
public const opttypestring    = 2  'optoptiontype
public const opttypeboolean   = 3  'optoptiontype
public const opttypeenumstr   = 4  'optoptiontype
public const opttypeenumint   = 5  'optoptiontype
public const opttypemultilist = 6  'optoptiontype
public const opttypestrlist   = 7  'optoptiontype
public const opttypemacro     = 8  'optoptiontype
public const opttypeimmediate = 9  'optoptiontype

public const optsubrequired = 0  'optoptionsubtype
public const optsubnovalue  = 1  'optoptionsubtype
public const optsuboptional = 2  'optoptionsubtype
public const optsub2values  = 3  'optoptionsubtype

public const optmsginputecho    = 0  'optmsgtype
public const optmsghelp         = 1  'optmsgtype
public const optmsgdefineerror  = 2  'optmsgtype
public const optmsgvalueerror   = 3  'optmsgtype
public const optmsgvaluewarning = 4  'optmsgtype
public const optmsgdeprecated   = 5  'optmsgtype
public const optmsgfileenter    = 6  'optmsgtype
public const optmsgfileleave    = 7  'optmsgtype
public const optmsgtoomanymsgs  = 8  'optmsgtype
public const optmsgusererror    = 9  'optmsgtype

public const optmapindicator  = 0  'optvarequmaptype
public const optmapdefinedvar = 1  'optvarequmaptype
#if win64 then
public declare ptrsafe sub optsetloadpath lib "optdclib64" (byval s as string)
public declare ptrsafe sub optgetloadpath lib "optdclib64" (byval s as string)
#else
public declare sub optsetloadpath lib "optdclib" (byval s as string)
public declare sub optgetloadpath lib "optdclib" (byval s as string)
#end if

#if win64 then
private declare ptrsafe function dll_optreaddefinition lib "optdclib64" alias "optreaddefinition" (byval popt as longptr,byref fn as byte) as long
private declare ptrsafe function dll_optreadparameterfile lib "optdclib64" alias "optreadparameterfile" (byval popt as longptr,byref fn as byte) as long
private declare ptrsafe sub dll_optreadfromstr lib "optdclib64" alias "optreadfromstr" (byval popt as longptr,byref s as byte)
private declare ptrsafe function dll_optwriteparameterfile lib "optdclib64" alias "optwriteparameterfile" (byval popt as longptr,byref fn as byte) as long
private declare ptrsafe sub dll_optclearmessages lib "optdclib64" alias "optclearmessages" (byval popt as longptr)
private declare ptrsafe sub dll_optaddmessage lib "optdclib64" alias "optaddmessage" (byval popt as longptr,byref info as byte)
private declare ptrsafe sub dll_optgetmessage lib "optdclib64" alias "optgetmessage" (byval popt as longptr,byval nrmsg as long,byref info as byte,byref itype as long)
private declare ptrsafe sub dll_optresetall lib "optdclib64" alias "optresetall" (byval popt as longptr)
private declare ptrsafe sub dll_optresetallrecent lib "optdclib64" alias "optresetallrecent" (byval popt as longptr)
private declare ptrsafe sub dll_optresetrecentchanges lib "optdclib64" alias "optresetrecentchanges" (byval popt as longptr)
private declare ptrsafe sub dll_optshowhelp lib "optdclib64" alias "optshowhelp" (byval popt as longptr,byref hlpid as byte)
private declare ptrsafe function dll_optresetnr lib "optdclib64" alias "optresetnr" (byval popt as longptr,byval anr as long) as long
private declare ptrsafe function dll_optfindstr lib "optdclib64" alias "optfindstr" (byval popt as longptr,byref aname as byte,byref anr as long,byref arefnr as long) as long
private declare ptrsafe function dll_optgetinfonr lib "optdclib64" alias "optgetinfonr" (byval popt as longptr,byval anr as long,byref adefined as long,byref adefinedr as long,byref arefnr as long,byref adatatype as long,byref aopttype as long,byref asubtype as long) as long
private declare ptrsafe function dll_optgetvaluesnr lib "optdclib64" alias "optgetvaluesnr" (byval popt as longptr,byval anr as long,byref asname as byte,byref aival as long,byref adval as double,byref asval as byte) as long
private declare ptrsafe function dll_optsetvaluesnr lib "optdclib64" alias "optsetvaluesnr" (byval popt as longptr,byval anr as long,byval aival as long,byval adval as double,byref asval as byte) as long
private declare ptrsafe function dll_optsetvalues2nr lib "optdclib64" alias "optsetvalues2nr" (byval popt as longptr,byval anr as long,byval aival as long,byval adval as double,byref asval as byte) as long
private declare ptrsafe sub dll_optversion lib "optdclib64" alias "optversion" (byval popt as longptr,byref sversion as byte)
private declare ptrsafe sub dll_optdefinitionfile lib "optdclib64" alias "optdefinitionfile" (byval popt as longptr,byref sfilename as byte)
private declare ptrsafe function dll_optgetfromanystrlist lib "optdclib64" alias "optgetfromanystrlist" (byval popt as longptr,byval idash as long,byref skey as byte,byref sval as byte) as long
private declare ptrsafe function dll_optgetfromliststr lib "optdclib64" alias "optgetfromliststr" (byval popt as longptr,byref skey as byte,byref sval as byte) as long
private declare ptrsafe function dll_optlistcountstr lib "optdclib64" alias "optlistcountstr" (byval popt as longptr,byref skey as byte) as long
private declare ptrsafe function dll_optreadfromliststr lib "optdclib64" alias "optreadfromliststr" (byval popt as longptr,byref skey as byte,byval ipos as long,byref sval as byte) as long
private declare ptrsafe function dll_optsynonymcount lib "optdclib64" alias "optsynonymcount" (byval popt as longptr) as long
private declare ptrsafe function dll_optgetsynonym lib "optdclib64" alias "optgetsynonym" (byval popt as longptr,byval nrsyn as long,byref ssyn as byte,byref sname as byte) as long
private declare ptrsafe sub dll_optechoset lib "optdclib64" alias "optechoset" (byval popt as longptr,byval aival as long)
private declare ptrsafe function dll_opteolonlyset lib "optdclib64" alias "opteolonlyset" (byval popt as longptr,byval aival as long) as long
private declare ptrsafe sub dll_optnoboundsset lib "optdclib64" alias "optnoboundsset" (byval popt as longptr,byval aival as long)
private declare ptrsafe sub dll_opterrorcount lib "optdclib64" alias "opterrorcount" (byval popt as longptr,byref ierrors as long,byref iwarnings as long)
private declare ptrsafe function dll_optgetboundsint lib "optdclib64" alias "optgetboundsint" (byval popt as longptr,byval anr as long,byref ilval as long,byref ihval as long,byref idval as long) as long
private declare ptrsafe function dll_optgetboundsdbl lib "optdclib64" alias "optgetboundsdbl" (byval popt as longptr,byval anr as long,byref dlval as double,byref dhval as double,byref ddval as double) as long
private declare ptrsafe function dll_optgetdefaultstr lib "optdclib64" alias "optgetdefaultstr" (byval popt as longptr,byval anr as long,byref sval as byte) as long
private declare ptrsafe function dll_optgetintnr lib "optdclib64" alias "optgetintnr" (byval popt as longptr,byval anr as long,byref aival as long) as long
private declare ptrsafe function dll_optgetint2nr lib "optdclib64" alias "optgetint2nr" (byval popt as longptr,byval anr as long,byref aival as long) as long
private declare ptrsafe function dll_optsetintnr lib "optdclib64" alias "optsetintnr" (byval popt as longptr,byval anr as long,byval aival as long) as long
private declare ptrsafe function dll_optsetint2nr lib "optdclib64" alias "optsetint2nr" (byval popt as longptr,byval anr as long,byval aival as long) as long
private declare ptrsafe function dll_optgetstrnr lib "optdclib64" alias "optgetstrnr" (byval popt as longptr,byval anr as long,byref asval as byte) as long
private declare ptrsafe function dll_optgetopthelpnr lib "optdclib64" alias "optgetopthelpnr" (byval popt as longptr,byval anr as long,byref aname as byte,byref ahc as long,byref agroup as long) as long
private declare ptrsafe function dll_optgetenumhelp lib "optdclib64" alias "optgetenumhelp" (byval popt as longptr,byval anr as long,byval aord as long,byref ahc as long,byref ahelpstr as byte) as long
private declare ptrsafe function dll_optgetenumstrnr lib "optdclib64" alias "optgetenumstrnr" (byval popt as longptr,byval anr as long,byref asval as byte,byref aord as long) as long
private declare ptrsafe function dll_optgetenumcount lib "optdclib64" alias "optgetenumcount" (byval popt as longptr,byval anr as long,byref acount as long) as long
private declare ptrsafe function dll_optgetenumvalue lib "optdclib64" alias "optgetenumvalue" (byval popt as longptr,byval anr as long,byval aord as long,byref avalint as long,byref avalstr as byte) as long
private declare ptrsafe function dll_optgetstr2nr lib "optdclib64" alias "optgetstr2nr" (byval popt as longptr,byval anr as long,byref asval as byte) as long
private declare ptrsafe function dll_optsetstrnr lib "optdclib64" alias "optsetstrnr" (byval popt as longptr,byval anr as long,byref asval as byte) as long
private declare ptrsafe function dll_optsetstr2nr lib "optdclib64" alias "optsetstr2nr" (byval popt as longptr,byval anr as long,byref asval as byte) as long
private declare ptrsafe function dll_optgetdblnr lib "optdclib64" alias "optgetdblnr" (byval popt as longptr,byval anr as long,byref adval as double) as long
private declare ptrsafe function dll_optgetdbl2nr lib "optdclib64" alias "optgetdbl2nr" (byval popt as longptr,byval anr as long,byref adval as double) as long
private declare ptrsafe function dll_optsetdblnr lib "optdclib64" alias "optsetdblnr" (byval popt as longptr,byval anr as long,byval adval as double) as long
private declare ptrsafe function dll_optsetdbl2nr lib "optdclib64" alias "optsetdbl2nr" (byval popt as longptr,byval anr as long,byval adval as double) as long
private declare ptrsafe function dll_optgetvalstr lib "optdclib64" alias "optgetvalstr" (byval popt as longptr,byref aname as byte,byref asval as byte) as long
private declare ptrsafe function dll_optgetval2str lib "optdclib64" alias "optgetval2str" (byval popt as longptr,byref aname as byte,byref asval as byte) as long
private declare ptrsafe function dll_optgetnamenr lib "optdclib64" alias "optgetnamenr" (byval popt as longptr,byval anr as long,byref asname as byte) as long
private declare ptrsafe function dll_optgetdefinednr lib "optdclib64" alias "optgetdefinednr" (byval popt as longptr,byval anr as long,byref aival as long) as long
private declare ptrsafe function dll_optgethelpnr lib "optdclib64" alias "optgethelpnr" (byval popt as longptr,byval anr as long,byref asopt as byte,byref ashelp as byte) as long
private declare ptrsafe function dll_optgetgroupnr lib "optdclib64" alias "optgetgroupnr" (byval popt as longptr,byval anr as long,byref aname as byte,byref agroup as long,byref ahc as long,byref ahelp as byte) as long
private declare ptrsafe function dll_optgetgroupgrpnr lib "optdclib64" alias "optgetgroupgrpnr" (byval popt as longptr,byval agroup as long) as long
private declare ptrsafe function dll_optgetoptgroupnr lib "optdclib64" alias "optgetoptgroupnr" (byval popt as longptr,byval anr as long) as long
private declare ptrsafe function dll_optgetdotoptnr lib "optdclib64" alias "optgetdotoptnr" (byval popt as longptr,byval anr as long,byref vename as byte,byref aobjnr as long,byref adim as long,byref avalue as double) as long
private declare ptrsafe function dll_optgetdotoptuel lib "optdclib64" alias "optgetdotoptuel" (byval popt as longptr,byval anr as long,byval adim as long,byref auel as byte) as long
private declare ptrsafe function dll_optgetvarequmapnr lib "optdclib64" alias "optgetvarequmapnr" (byval popt as longptr,byval maptype as long,byval anr as long,byref equname as byte,byref varname as byte,byref equdim as long,byref vardim as long,byref avalue as long) as long
private declare ptrsafe function dll_optgetequvarequmapnr lib "optdclib64" alias "optgetequvarequmapnr" (byval popt as longptr,byval maptype as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare ptrsafe function dll_optgetvarvarequmapnr lib "optdclib64" alias "optgetvarvarequmapnr" (byval popt as longptr,byval maptype as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare ptrsafe function dll_optvarequmapcount lib "optdclib64" alias "optvarequmapcount" (byval popt as longptr,byval maptype as long,byref anrerrors as long) as long
private declare ptrsafe function dll_optgetindicatornr lib "optdclib64" alias "optgetindicatornr" (byval popt as longptr,byval anr as long,byref equname as byte,byref varname as byte,byref equdim as long,byref vardim as long,byref avalue as long) as long
private declare ptrsafe function dll_optgetequindicatornr lib "optdclib64" alias "optgetequindicatornr" (byval popt as longptr,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare ptrsafe function dll_optgetvarindicatornr lib "optdclib64" alias "optgetvarindicatornr" (byval popt as longptr,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare ptrsafe function dll_optindicatorcount lib "optdclib64" alias "optindicatorcount" (byval popt as longptr,byref anrerrors as long) as long
private declare ptrsafe function dll_optdotoptcount lib "optdclib64" alias "optdotoptcount" (byval popt as longptr,byref anrerrors as long) as long
private declare ptrsafe function dll_optsetrefnr lib "optdclib64" alias "optsetrefnr" (byval popt as longptr,byval anr as long,byval arefnr as long) as long
private declare ptrsafe function dll_optsetrefnrstr lib "optdclib64" alias "optsetrefnrstr" (byval popt as longptr,byref aopt as byte,byval arefnr as long) as long
private declare ptrsafe function dll_optgetconstname lib "optdclib64" alias "optgetconstname" (byval popt as longptr,byval cgroup as long,byval cindex as long,byref cname as byte) as long
private declare ptrsafe function dll_optgettypename lib "optdclib64" alias "optgettypename" (byval popt as longptr,byval tnr as long,byref stname as byte) as long
private declare ptrsafe function dll_optlookup lib "optdclib64" alias "optlookup" (byval popt as longptr,byref aopt as byte) as long
private declare ptrsafe sub dll_optreadfrompchar lib "optdclib64" alias "optreadfrompchar" (byval popt as longptr,byref p as byte)
private declare ptrsafe function dll_optgetnameopt lib "optdclib64" alias "optgetnameopt" (byval popt as longptr,byref asval as byte,byref solver as byte,byref opt as long) as long
private declare ptrsafe function dll_optgetdefinedstr lib "optdclib64" alias "optgetdefinedstr" (byval popt as longptr,byref aname as byte) as long
private declare ptrsafe function dll_optgetintstr lib "optdclib64" alias "optgetintstr" (byval popt as longptr,byref aname as byte) as long
private declare ptrsafe function dll_optgetdblstr lib "optdclib64" alias "optgetdblstr" (byval popt as longptr,byref aname as byte) as double
private declare ptrsafe sub dll_optgetstrstr lib "optdclib64" alias "coptgetstrstr" (byval popt as longptr,byref aname as byte,byref sst_result as byte)
private declare ptrsafe sub dll_optsetintstr lib "optdclib64" alias "optsetintstr" (byval popt as longptr,byref aname as byte,byval aival as long)
private declare ptrsafe sub dll_optsetdblstr lib "optdclib64" alias "optsetdblstr" (byval popt as longptr,byref aname as byte,byval adval as double)
private declare ptrsafe sub dll_optsetstrstr lib "optdclib64" alias "optsetstrstr" (byval popt as longptr,byref aname as byte,byref asval as byte)

private declare ptrsafe function dll_optcount lib "optdclib64" alias "optcount" (byval popt as longptr) as long
private declare ptrsafe function dll_optmessagecount lib "optdclib64" alias "optmessagecount" (byval popt as longptr) as long
private declare ptrsafe function dll_optgroupcount lib "optdclib64" alias "optgroupcount" (byval popt as longptr) as long
private declare ptrsafe function dll_optrecentenabled lib "optdclib64" alias "optrecentenabled" (byval popt as longptr) as long
private declare ptrsafe sub dll_optrecentenabledset lib "optdclib64" alias "optrecentenabledset" (byval popt as longptr, byval  x as long)
#else
private declare function dll_optreaddefinition lib "optdclib" alias "optreaddefinition" (byval popt as long,byref fn as byte) as long
private declare function dll_optreadparameterfile lib "optdclib" alias "optreadparameterfile" (byval popt as long,byref fn as byte) as long
private declare sub dll_optreadfromstr lib "optdclib" alias "optreadfromstr" (byval popt as long,byref s as byte)
private declare function dll_optwriteparameterfile lib "optdclib" alias "optwriteparameterfile" (byval popt as long,byref fn as byte) as long
private declare sub dll_optclearmessages lib "optdclib" alias "optclearmessages" (byval popt as long)
private declare sub dll_optaddmessage lib "optdclib" alias "optaddmessage" (byval popt as long,byref info as byte)
private declare sub dll_optgetmessage lib "optdclib" alias "optgetmessage" (byval popt as long,byval nrmsg as long,byref info as byte,byref itype as long)
private declare sub dll_optresetall lib "optdclib" alias "optresetall" (byval popt as long)
private declare sub dll_optresetallrecent lib "optdclib" alias "optresetallrecent" (byval popt as long)
private declare sub dll_optresetrecentchanges lib "optdclib" alias "optresetrecentchanges" (byval popt as long)
private declare sub dll_optshowhelp lib "optdclib" alias "optshowhelp" (byval popt as long,byref hlpid as byte)
private declare function dll_optresetnr lib "optdclib" alias "optresetnr" (byval popt as long,byval anr as long) as long
private declare function dll_optfindstr lib "optdclib" alias "optfindstr" (byval popt as long,byref aname as byte,byref anr as long,byref arefnr as long) as long
private declare function dll_optgetinfonr lib "optdclib" alias "optgetinfonr" (byval popt as long,byval anr as long,byref adefined as long,byref adefinedr as long,byref arefnr as long,byref adatatype as long,byref aopttype as long,byref asubtype as long) as long
private declare function dll_optgetvaluesnr lib "optdclib" alias "optgetvaluesnr" (byval popt as long,byval anr as long,byref asname as byte,byref aival as long,byref adval as double,byref asval as byte) as long
private declare function dll_optsetvaluesnr lib "optdclib" alias "optsetvaluesnr" (byval popt as long,byval anr as long,byval aival as long,byval adval as double,byref asval as byte) as long
private declare function dll_optsetvalues2nr lib "optdclib" alias "optsetvalues2nr" (byval popt as long,byval anr as long,byval aival as long,byval adval as double,byref asval as byte) as long
private declare sub dll_optversion lib "optdclib" alias "optversion" (byval popt as long,byref sversion as byte)
private declare sub dll_optdefinitionfile lib "optdclib" alias "optdefinitionfile" (byval popt as long,byref sfilename as byte)
private declare function dll_optgetfromanystrlist lib "optdclib" alias "optgetfromanystrlist" (byval popt as long,byval idash as long,byref skey as byte,byref sval as byte) as long
private declare function dll_optgetfromliststr lib "optdclib" alias "optgetfromliststr" (byval popt as long,byref skey as byte,byref sval as byte) as long
private declare function dll_optlistcountstr lib "optdclib" alias "optlistcountstr" (byval popt as long,byref skey as byte) as long
private declare function dll_optreadfromliststr lib "optdclib" alias "optreadfromliststr" (byval popt as long,byref skey as byte,byval ipos as long,byref sval as byte) as long
private declare function dll_optsynonymcount lib "optdclib" alias "optsynonymcount" (byval popt as long) as long
private declare function dll_optgetsynonym lib "optdclib" alias "optgetsynonym" (byval popt as long,byval nrsyn as long,byref ssyn as byte,byref sname as byte) as long
private declare sub dll_optechoset lib "optdclib" alias "optechoset" (byval popt as long,byval aival as long)
private declare function dll_opteolonlyset lib "optdclib" alias "opteolonlyset" (byval popt as long,byval aival as long) as long
private declare sub dll_optnoboundsset lib "optdclib" alias "optnoboundsset" (byval popt as long,byval aival as long)
private declare sub dll_opterrorcount lib "optdclib" alias "opterrorcount" (byval popt as long,byref ierrors as long,byref iwarnings as long)
private declare function dll_optgetboundsint lib "optdclib" alias "optgetboundsint" (byval popt as long,byval anr as long,byref ilval as long,byref ihval as long,byref idval as long) as long
private declare function dll_optgetboundsdbl lib "optdclib" alias "optgetboundsdbl" (byval popt as long,byval anr as long,byref dlval as double,byref dhval as double,byref ddval as double) as long
private declare function dll_optgetdefaultstr lib "optdclib" alias "optgetdefaultstr" (byval popt as long,byval anr as long,byref sval as byte) as long
private declare function dll_optgetintnr lib "optdclib" alias "optgetintnr" (byval popt as long,byval anr as long,byref aival as long) as long
private declare function dll_optgetint2nr lib "optdclib" alias "optgetint2nr" (byval popt as long,byval anr as long,byref aival as long) as long
private declare function dll_optsetintnr lib "optdclib" alias "optsetintnr" (byval popt as long,byval anr as long,byval aival as long) as long
private declare function dll_optsetint2nr lib "optdclib" alias "optsetint2nr" (byval popt as long,byval anr as long,byval aival as long) as long
private declare function dll_optgetstrnr lib "optdclib" alias "optgetstrnr" (byval popt as long,byval anr as long,byref asval as byte) as long
private declare function dll_optgetopthelpnr lib "optdclib" alias "optgetopthelpnr" (byval popt as long,byval anr as long,byref aname as byte,byref ahc as long,byref agroup as long) as long
private declare function dll_optgetenumhelp lib "optdclib" alias "optgetenumhelp" (byval popt as long,byval anr as long,byval aord as long,byref ahc as long,byref ahelpstr as byte) as long
private declare function dll_optgetenumstrnr lib "optdclib" alias "optgetenumstrnr" (byval popt as long,byval anr as long,byref asval as byte,byref aord as long) as long
private declare function dll_optgetenumcount lib "optdclib" alias "optgetenumcount" (byval popt as long,byval anr as long,byref acount as long) as long
private declare function dll_optgetenumvalue lib "optdclib" alias "optgetenumvalue" (byval popt as long,byval anr as long,byval aord as long,byref avalint as long,byref avalstr as byte) as long
private declare function dll_optgetstr2nr lib "optdclib" alias "optgetstr2nr" (byval popt as long,byval anr as long,byref asval as byte) as long
private declare function dll_optsetstrnr lib "optdclib" alias "optsetstrnr" (byval popt as long,byval anr as long,byref asval as byte) as long
private declare function dll_optsetstr2nr lib "optdclib" alias "optsetstr2nr" (byval popt as long,byval anr as long,byref asval as byte) as long
private declare function dll_optgetdblnr lib "optdclib" alias "optgetdblnr" (byval popt as long,byval anr as long,byref adval as double) as long
private declare function dll_optgetdbl2nr lib "optdclib" alias "optgetdbl2nr" (byval popt as long,byval anr as long,byref adval as double) as long
private declare function dll_optsetdblnr lib "optdclib" alias "optsetdblnr" (byval popt as long,byval anr as long,byval adval as double) as long
private declare function dll_optsetdbl2nr lib "optdclib" alias "optsetdbl2nr" (byval popt as long,byval anr as long,byval adval as double) as long
private declare function dll_optgetvalstr lib "optdclib" alias "optgetvalstr" (byval popt as long,byref aname as byte,byref asval as byte) as long
private declare function dll_optgetval2str lib "optdclib" alias "optgetval2str" (byval popt as long,byref aname as byte,byref asval as byte) as long
private declare function dll_optgetnamenr lib "optdclib" alias "optgetnamenr" (byval popt as long,byval anr as long,byref asname as byte) as long
private declare function dll_optgetdefinednr lib "optdclib" alias "optgetdefinednr" (byval popt as long,byval anr as long,byref aival as long) as long
private declare function dll_optgethelpnr lib "optdclib" alias "optgethelpnr" (byval popt as long,byval anr as long,byref asopt as byte,byref ashelp as byte) as long
private declare function dll_optgetgroupnr lib "optdclib" alias "optgetgroupnr" (byval popt as long,byval anr as long,byref aname as byte,byref agroup as long,byref ahc as long,byref ahelp as byte) as long
private declare function dll_optgetgroupgrpnr lib "optdclib" alias "optgetgroupgrpnr" (byval popt as long,byval agroup as long) as long
private declare function dll_optgetoptgroupnr lib "optdclib" alias "optgetoptgroupnr" (byval popt as long,byval anr as long) as long
private declare function dll_optgetdotoptnr lib "optdclib" alias "optgetdotoptnr" (byval popt as long,byval anr as long,byref vename as byte,byref aobjnr as long,byref adim as long,byref avalue as double) as long
private declare function dll_optgetdotoptuel lib "optdclib" alias "optgetdotoptuel" (byval popt as long,byval anr as long,byval adim as long,byref auel as byte) as long
private declare function dll_optgetvarequmapnr lib "optdclib" alias "optgetvarequmapnr" (byval popt as long,byval maptype as long,byval anr as long,byref equname as byte,byref varname as byte,byref equdim as long,byref vardim as long,byref avalue as long) as long
private declare function dll_optgetequvarequmapnr lib "optdclib" alias "optgetequvarequmapnr" (byval popt as long,byval maptype as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare function dll_optgetvarvarequmapnr lib "optdclib" alias "optgetvarvarequmapnr" (byval popt as long,byval maptype as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare function dll_optvarequmapcount lib "optdclib" alias "optvarequmapcount" (byval popt as long,byval maptype as long,byref anrerrors as long) as long
private declare function dll_optgetindicatornr lib "optdclib" alias "optgetindicatornr" (byval popt as long,byval anr as long,byref equname as byte,byref varname as byte,byref equdim as long,byref vardim as long,byref avalue as long) as long
private declare function dll_optgetequindicatornr lib "optdclib" alias "optgetequindicatornr" (byval popt as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare function dll_optgetvarindicatornr lib "optdclib" alias "optgetvarindicatornr" (byval popt as long,byval anr as long,byval adim as long,byref aindex as byte) as long
private declare function dll_optindicatorcount lib "optdclib" alias "optindicatorcount" (byval popt as long,byref anrerrors as long) as long
private declare function dll_optdotoptcount lib "optdclib" alias "optdotoptcount" (byval popt as long,byref anrerrors as long) as long
private declare function dll_optsetrefnr lib "optdclib" alias "optsetrefnr" (byval popt as long,byval anr as long,byval arefnr as long) as long
private declare function dll_optsetrefnrstr lib "optdclib" alias "optsetrefnrstr" (byval popt as long,byref aopt as byte,byval arefnr as long) as long
private declare function dll_optgetconstname lib "optdclib" alias "optgetconstname" (byval popt as long,byval cgroup as long,byval cindex as long,byref cname as byte) as long
private declare function dll_optgettypename lib "optdclib" alias "optgettypename" (byval popt as long,byval tnr as long,byref stname as byte) as long
private declare function dll_optlookup lib "optdclib" alias "optlookup" (byval popt as long,byref aopt as byte) as long
private declare sub dll_optreadfrompchar lib "optdclib" alias "optreadfrompchar" (byval popt as long,byref p as byte)
private declare function dll_optgetnameopt lib "optdclib" alias "optgetnameopt" (byval popt as long,byref asval as byte,byref solver as byte,byref opt as long) as long
private declare function dll_optgetdefinedstr lib "optdclib" alias "optgetdefinedstr" (byval popt as long,byref aname as byte) as long
private declare function dll_optgetintstr lib "optdclib" alias "optgetintstr" (byval popt as long,byref aname as byte) as long
private declare function dll_optgetdblstr lib "optdclib" alias "optgetdblstr" (byval popt as long,byref aname as byte) as double
private declare sub dll_optgetstrstr lib "optdclib" alias "coptgetstrstr" (byval popt as long,byref aname as byte,byref sst_result as byte)
private declare sub dll_optsetintstr lib "optdclib" alias "optsetintstr" (byval popt as long,byref aname as byte,byval aival as long)
private declare sub dll_optsetdblstr lib "optdclib" alias "optsetdblstr" (byval popt as long,byref aname as byte,byval adval as double)
private declare sub dll_optsetstrstr lib "optdclib" alias "optsetstrstr" (byval popt as long,byref aname as byte,byref asval as byte)

private declare function dll_optcount lib "optdclib" alias "optcount" (byval popt as long) as long
private declare function dll_optmessagecount lib "optdclib" alias "optmessagecount" (byval popt as long) as long
private declare function dll_optgroupcount lib "optdclib" alias "optgroupcount" (byval popt as long) as long
private declare function dll_optrecentenabled lib "optdclib" alias "optrecentenabled" (byval popt as long) as long
private declare sub dll_optrecentenabledset lib "optdclib" alias "optrecentenabledset" (byval popt as long, byval  x as long)
#end if

#if win64 then
private declare ptrsafe sub xcreate lib "optdclib64" (byref popt as longptr)
private declare ptrsafe sub xfree   lib "optdclib64" (byref popt as longptr)
#else
private declare sub xcreate lib "optdclib" (byref popt as long)
private declare sub xfree   lib "optdclib" (byref popt as long)
#end if

public function optcreate(byref popt as vbaptr, byref msgbuf as string) as boolean
    call xcreate(popt.p)
    if popt.p <> 0 then
        optcreate = true
    else
        optcreate = false
    end if
end function

public function optcreatex(byref popt as vbaptr, byref msgbuf as string) as boolean
    call xcreate(popt.p)
    if popt.p <> 0 then
        optcreatex = true
    else
        optcreatex = false
    end if
end function

public function optcreated(byref popt as vbaptr, byval dirname as string, byref msgbuf as string) as boolean
    call xcreate(popt.p)
    if popt.p <> 0 then
        optcreated = true
    else
        optcreated = false
    end if
end function

public function optcreatel(byref popt as vbaptr, byval libname as string, byref msgbuf as string) as boolean
    call xcreate(popt.p)
    if popt.p <> 0 then
        optcreatel = true
    else
        optcreatel = false
    end if
end function

public function optfree(byref popt as vbaptr) as boolean
   call xfree(popt.p)
   optfree = true
end function

private sub convertbas2pas(s as string, b() as byte)
    dim i as integer
    dim slen as integer
    slen = len(s)
    if (slen > ubound(b)) then
        slen = ubound(b)
    end if
    b(0) = slen
    for i = 1 to slen
        b(i) = asc(mid(s, i, 1))
    next i
end sub

private sub convertpas2bas(b() as byte, s as string)
    dim i as integer
    dim slen as integer
    slen = b(0)
    s = ""
    for i = 1 to slen
        s = s & chr(b(i))
    next i
end sub

private sub convertc2bas(b() as byte, s as string)
    dim i as integer
    s = ""
    i = 0
    do while b(i) <> 0
        s = s & chr(b(i))
        i = i + 1
    loop
end sub

public function optreaddefinition(popt as vbaptr,fn as string) as long
   dim cpy_fn as string255
   call convertbas2pas(fn, cpy_fn.s)
   optreaddefinition = dll_optreaddefinition(popt.p,cpy_fn.s(0))
end function

public function optreadparameterfile(popt as vbaptr,fn as string) as long
   dim cpy_fn as string255
   call convertbas2pas(fn, cpy_fn.s)
   optreadparameterfile = dll_optreadparameterfile(popt.p,cpy_fn.s(0))
end function

public sub optreadfromstr(popt as vbaptr,s as string)
   dim cpy_s as string255
   call convertbas2pas(s, cpy_s.s)
   call dll_optreadfromstr(popt.p,cpy_s.s(0))
end sub

public function optwriteparameterfile(popt as vbaptr,fn as string) as long
   dim cpy_fn as string255
   call convertbas2pas(fn, cpy_fn.s)
   optwriteparameterfile = dll_optwriteparameterfile(popt.p,cpy_fn.s(0))
end function

public sub optclearmessages(popt as vbaptr)
   call dll_optclearmessages(popt.p)
end sub

public sub optaddmessage(popt as vbaptr,info as string)
   dim cpy_info as string255
   call convertbas2pas(info, cpy_info.s)
   call dll_optaddmessage(popt.p,cpy_info.s(0))
end sub

public sub optgetmessage(popt as vbaptr,nrmsg as long,info as string,itype as long)
   dim cpy_info as string255
   call dll_optgetmessage(popt.p,nrmsg,cpy_info.s(0),itype)
   call convertpas2bas(cpy_info.s,info)
end sub

public sub optresetall(popt as vbaptr)
   call dll_optresetall(popt.p)
end sub

public sub optresetallrecent(popt as vbaptr)
   call dll_optresetallrecent(popt.p)
end sub

public sub optresetrecentchanges(popt as vbaptr)
   call dll_optresetrecentchanges(popt.p)
end sub

public sub optshowhelp(popt as vbaptr,hlpid as string)
   dim cpy_hlpid as string255
   call convertbas2pas(hlpid, cpy_hlpid.s)
   call dll_optshowhelp(popt.p,cpy_hlpid.s(0))
end sub

public function optresetnr(popt as vbaptr,anr as long) as long
   optresetnr = dll_optresetnr(popt.p,anr)
end function

public function optfindstr(popt as vbaptr,aname as string,anr as long,arefnr as long) as long
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   optfindstr = dll_optfindstr(popt.p,cpy_aname.s(0),anr,arefnr)
end function

public function optgetinfonr(popt as vbaptr,anr as long,adefined as long,adefinedr as long,arefnr as long,adatatype as long,aopttype as long,asubtype as long) as long
   optgetinfonr = dll_optgetinfonr(popt.p,anr,adefined,adefinedr,arefnr,adatatype,aopttype,asubtype)
end function

public function optgetvaluesnr(popt as vbaptr,anr as long,asname as string,aival as long,adval as double,asval as string) as long
   dim cpy_asname as string255
   dim cpy_asval as string255
   optgetvaluesnr = dll_optgetvaluesnr(popt.p,anr,cpy_asname.s(0),aival,adval,cpy_asval.s(0))
   call convertpas2bas(cpy_asname.s,asname)
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optsetvaluesnr(popt as vbaptr,anr as long,aival as long,adval as double,asval as string) as long
   dim cpy_asval as string255
   call convertbas2pas(asval, cpy_asval.s)
   optsetvaluesnr = dll_optsetvaluesnr(popt.p,anr,aival,adval,cpy_asval.s(0))
end function

public function optsetvalues2nr(popt as vbaptr,anr as long,aival as long,adval as double,asval as string) as long
   dim cpy_asval as string255
   call convertbas2pas(asval, cpy_asval.s)
   optsetvalues2nr = dll_optsetvalues2nr(popt.p,anr,aival,adval,cpy_asval.s(0))
end function

public sub optversion(popt as vbaptr,sversion as string)
   dim cpy_sversion as string255
   call dll_optversion(popt.p,cpy_sversion.s(0))
   call convertpas2bas(cpy_sversion.s,sversion)
end sub

public sub optdefinitionfile(popt as vbaptr,sfilename as string)
   dim cpy_sfilename as string255
   call dll_optdefinitionfile(popt.p,cpy_sfilename.s(0))
   call convertpas2bas(cpy_sfilename.s,sfilename)
end sub

public function optgetfromanystrlist(popt as vbaptr,idash as long,skey as string,sval as string) as long
   dim cpy_skey as string255
   dim cpy_sval as string255
   optgetfromanystrlist = dll_optgetfromanystrlist(popt.p,idash,cpy_skey.s(0),cpy_sval.s(0))
   call convertpas2bas(cpy_skey.s,skey)
   call convertpas2bas(cpy_sval.s,sval)
end function

public function optgetfromliststr(popt as vbaptr,skey as string,sval as string) as long
   dim cpy_skey as string255
   dim cpy_sval as string255
   call convertbas2pas(skey, cpy_skey.s)
   optgetfromliststr = dll_optgetfromliststr(popt.p,cpy_skey.s(0),cpy_sval.s(0))
   call convertpas2bas(cpy_sval.s,sval)
end function

public function optlistcountstr(popt as vbaptr,skey as string) as long
   dim cpy_skey as string255
   call convertbas2pas(skey, cpy_skey.s)
   optlistcountstr = dll_optlistcountstr(popt.p,cpy_skey.s(0))
end function

public function optreadfromliststr(popt as vbaptr,skey as string,ipos as long,sval as string) as long
   dim cpy_skey as string255
   dim cpy_sval as string255
   call convertbas2pas(skey, cpy_skey.s)
   optreadfromliststr = dll_optreadfromliststr(popt.p,cpy_skey.s(0),ipos,cpy_sval.s(0))
   call convertpas2bas(cpy_sval.s,sval)
end function

public function optsynonymcount(popt as vbaptr) as long
   optsynonymcount = dll_optsynonymcount(popt.p)
end function

public function optgetsynonym(popt as vbaptr,nrsyn as long,ssyn as string,sname as string) as long
   dim cpy_ssyn as string255
   dim cpy_sname as string255
   optgetsynonym = dll_optgetsynonym(popt.p,nrsyn,cpy_ssyn.s(0),cpy_sname.s(0))
   call convertpas2bas(cpy_ssyn.s,ssyn)
   call convertpas2bas(cpy_sname.s,sname)
end function

public sub optechoset(popt as vbaptr,aival as long)
   call dll_optechoset(popt.p,aival)
end sub

public function opteolonlyset(popt as vbaptr,aival as long) as long
   opteolonlyset = dll_opteolonlyset(popt.p,aival)
end function

public sub optnoboundsset(popt as vbaptr,aival as long)
   call dll_optnoboundsset(popt.p,aival)
end sub

public sub opterrorcount(popt as vbaptr,ierrors as long,iwarnings as long)
   call dll_opterrorcount(popt.p,ierrors,iwarnings)
end sub

public function optgetboundsint(popt as vbaptr,anr as long,ilval as long,ihval as long,idval as long) as long
   optgetboundsint = dll_optgetboundsint(popt.p,anr,ilval,ihval,idval)
end function

public function optgetboundsdbl(popt as vbaptr,anr as long,dlval as double,dhval as double,ddval as double) as long
   optgetboundsdbl = dll_optgetboundsdbl(popt.p,anr,dlval,dhval,ddval)
end function

public function optgetdefaultstr(popt as vbaptr,anr as long,sval as string) as long
   dim cpy_sval as string255
   optgetdefaultstr = dll_optgetdefaultstr(popt.p,anr,cpy_sval.s(0))
   call convertpas2bas(cpy_sval.s,sval)
end function

public function optgetintnr(popt as vbaptr,anr as long,aival as long) as long
   optgetintnr = dll_optgetintnr(popt.p,anr,aival)
end function

public function optgetint2nr(popt as vbaptr,anr as long,aival as long) as long
   optgetint2nr = dll_optgetint2nr(popt.p,anr,aival)
end function

public function optsetintnr(popt as vbaptr,anr as long,aival as long) as long
   optsetintnr = dll_optsetintnr(popt.p,anr,aival)
end function

public function optsetint2nr(popt as vbaptr,anr as long,aival as long) as long
   optsetint2nr = dll_optsetint2nr(popt.p,anr,aival)
end function

public function optgetstrnr(popt as vbaptr,anr as long,asval as string) as long
   dim cpy_asval as string255
   optgetstrnr = dll_optgetstrnr(popt.p,anr,cpy_asval.s(0))
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optgetopthelpnr(popt as vbaptr,anr as long,aname as string,ahc as long,agroup as long) as long
   dim cpy_aname as string255
   optgetopthelpnr = dll_optgetopthelpnr(popt.p,anr,cpy_aname.s(0),ahc,agroup)
   call convertpas2bas(cpy_aname.s,aname)
end function

public function optgetenumhelp(popt as vbaptr,anr as long,aord as long,ahc as long,ahelpstr as string) as long
   dim cpy_ahelpstr as string255
   optgetenumhelp = dll_optgetenumhelp(popt.p,anr,aord,ahc,cpy_ahelpstr.s(0))
   call convertpas2bas(cpy_ahelpstr.s,ahelpstr)
end function

public function optgetenumstrnr(popt as vbaptr,anr as long,asval as string,aord as long) as long
   dim cpy_asval as string255
   optgetenumstrnr = dll_optgetenumstrnr(popt.p,anr,cpy_asval.s(0),aord)
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optgetenumcount(popt as vbaptr,anr as long,acount as long) as long
   optgetenumcount = dll_optgetenumcount(popt.p,anr,acount)
end function

public function optgetenumvalue(popt as vbaptr,anr as long,aord as long,avalint as long,avalstr as string) as long
   dim cpy_avalstr as string255
   optgetenumvalue = dll_optgetenumvalue(popt.p,anr,aord,avalint,cpy_avalstr.s(0))
   call convertpas2bas(cpy_avalstr.s,avalstr)
end function

public function optgetstr2nr(popt as vbaptr,anr as long,asval as string) as long
   dim cpy_asval as string255
   optgetstr2nr = dll_optgetstr2nr(popt.p,anr,cpy_asval.s(0))
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optsetstrnr(popt as vbaptr,anr as long,asval as string) as long
   dim cpy_asval as string255
   call convertbas2pas(asval, cpy_asval.s)
   optsetstrnr = dll_optsetstrnr(popt.p,anr,cpy_asval.s(0))
end function

public function optsetstr2nr(popt as vbaptr,anr as long,asval as string) as long
   dim cpy_asval as string255
   call convertbas2pas(asval, cpy_asval.s)
   optsetstr2nr = dll_optsetstr2nr(popt.p,anr,cpy_asval.s(0))
end function

public function optgetdblnr(popt as vbaptr,anr as long,adval as double) as long
   optgetdblnr = dll_optgetdblnr(popt.p,anr,adval)
end function

public function optgetdbl2nr(popt as vbaptr,anr as long,adval as double) as long
   optgetdbl2nr = dll_optgetdbl2nr(popt.p,anr,adval)
end function

public function optsetdblnr(popt as vbaptr,anr as long,adval as double) as long
   optsetdblnr = dll_optsetdblnr(popt.p,anr,adval)
end function

public function optsetdbl2nr(popt as vbaptr,anr as long,adval as double) as long
   optsetdbl2nr = dll_optsetdbl2nr(popt.p,anr,adval)
end function

public function optgetvalstr(popt as vbaptr,aname as string,asval as string) as long
   dim cpy_aname as string255
   dim cpy_asval as string255
   call convertbas2pas(aname, cpy_aname.s)
   optgetvalstr = dll_optgetvalstr(popt.p,cpy_aname.s(0),cpy_asval.s(0))
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optgetval2str(popt as vbaptr,aname as string,asval as string) as long
   dim cpy_aname as string255
   dim cpy_asval as string255
   call convertbas2pas(aname, cpy_aname.s)
   optgetval2str = dll_optgetval2str(popt.p,cpy_aname.s(0),cpy_asval.s(0))
   call convertpas2bas(cpy_asval.s,asval)
end function

public function optgetnamenr(popt as vbaptr,anr as long,asname as string) as long
   dim cpy_asname as string255
   optgetnamenr = dll_optgetnamenr(popt.p,anr,cpy_asname.s(0))
   call convertpas2bas(cpy_asname.s,asname)
end function

public function optgetdefinednr(popt as vbaptr,anr as long,aival as long) as long
   optgetdefinednr = dll_optgetdefinednr(popt.p,anr,aival)
end function

public function optgethelpnr(popt as vbaptr,anr as long,asopt as string,ashelp as string) as long
   dim cpy_asopt as string255
   dim cpy_ashelp as string255
   optgethelpnr = dll_optgethelpnr(popt.p,anr,cpy_asopt.s(0),cpy_ashelp.s(0))
   call convertpas2bas(cpy_asopt.s,asopt)
   call convertpas2bas(cpy_ashelp.s,ashelp)
end function

public function optgetgroupnr(popt as vbaptr,anr as long,aname as string,agroup as long,ahc as long,ahelp as string) as long
   dim cpy_aname as string255
   dim cpy_ahelp as string255
   optgetgroupnr = dll_optgetgroupnr(popt.p,anr,cpy_aname.s(0),agroup,ahc,cpy_ahelp.s(0))
   call convertpas2bas(cpy_aname.s,aname)
   call convertpas2bas(cpy_ahelp.s,ahelp)
end function

public function optgetgroupgrpnr(popt as vbaptr,agroup as long) as long
   optgetgroupgrpnr = dll_optgetgroupgrpnr(popt.p,agroup)
end function

public function optgetoptgroupnr(popt as vbaptr,anr as long) as long
   optgetoptgroupnr = dll_optgetoptgroupnr(popt.p,anr)
end function

public function optgetdotoptnr(popt as vbaptr,anr as long,vename as string,aobjnr as long,adim as long,avalue as double) as long
   dim cpy_vename as string255
   optgetdotoptnr = dll_optgetdotoptnr(popt.p,anr,cpy_vename.s(0),aobjnr,adim,avalue)
   call convertpas2bas(cpy_vename.s,vename)
end function

public function optgetdotoptuel(popt as vbaptr,anr as long,adim as long,auel as string) as long
   dim cpy_auel as string255
   optgetdotoptuel = dll_optgetdotoptuel(popt.p,anr,adim,cpy_auel.s(0))
   call convertpas2bas(cpy_auel.s,auel)
end function

public function optgetvarequmapnr(popt as vbaptr,maptype as long,anr as long,equname as string,varname as string,equdim as long,vardim as long,avalue as long) as long
   dim cpy_equname as string255
   dim cpy_varname as string255
   optgetvarequmapnr = dll_optgetvarequmapnr(popt.p,maptype,anr,cpy_equname.s(0),cpy_varname.s(0),equdim,vardim,avalue)
   call convertpas2bas(cpy_equname.s,equname)
   call convertpas2bas(cpy_varname.s,varname)
end function

public function optgetequvarequmapnr(popt as vbaptr,maptype as long,anr as long,adim as long,aindex as string) as long
   dim cpy_aindex as string255
   optgetequvarequmapnr = dll_optgetequvarequmapnr(popt.p,maptype,anr,adim,cpy_aindex.s(0))
   call convertpas2bas(cpy_aindex.s,aindex)
end function

public function optgetvarvarequmapnr(popt as vbaptr,maptype as long,anr as long,adim as long,aindex as string) as long
   dim cpy_aindex as string255
   optgetvarvarequmapnr = dll_optgetvarvarequmapnr(popt.p,maptype,anr,adim,cpy_aindex.s(0))
   call convertpas2bas(cpy_aindex.s,aindex)
end function

public function optvarequmapcount(popt as vbaptr,maptype as long,anrerrors as long) as long
   optvarequmapcount = dll_optvarequmapcount(popt.p,maptype,anrerrors)
end function

public function optgetindicatornr(popt as vbaptr,anr as long,equname as string,varname as string,equdim as long,vardim as long,avalue as long) as long
   dim cpy_equname as string255
   dim cpy_varname as string255
   optgetindicatornr = dll_optgetindicatornr(popt.p,anr,cpy_equname.s(0),cpy_varname.s(0),equdim,vardim,avalue)
   call convertpas2bas(cpy_equname.s,equname)
   call convertpas2bas(cpy_varname.s,varname)
end function

public function optgetequindicatornr(popt as vbaptr,anr as long,adim as long,aindex as string) as long
   dim cpy_aindex as string255
   optgetequindicatornr = dll_optgetequindicatornr(popt.p,anr,adim,cpy_aindex.s(0))
   call convertpas2bas(cpy_aindex.s,aindex)
end function

public function optgetvarindicatornr(popt as vbaptr,anr as long,adim as long,aindex as string) as long
   dim cpy_aindex as string255
   optgetvarindicatornr = dll_optgetvarindicatornr(popt.p,anr,adim,cpy_aindex.s(0))
   call convertpas2bas(cpy_aindex.s,aindex)
end function

public function optindicatorcount(popt as vbaptr,anrerrors as long) as long
   optindicatorcount = dll_optindicatorcount(popt.p,anrerrors)
end function

public function optdotoptcount(popt as vbaptr,anrerrors as long) as long
   optdotoptcount = dll_optdotoptcount(popt.p,anrerrors)
end function

public function optsetrefnr(popt as vbaptr,anr as long,arefnr as long) as long
   optsetrefnr = dll_optsetrefnr(popt.p,anr,arefnr)
end function

public function optsetrefnrstr(popt as vbaptr,aopt as string,arefnr as long) as long
   dim cpy_aopt as string255
   call convertbas2pas(aopt, cpy_aopt.s)
   optsetrefnrstr = dll_optsetrefnrstr(popt.p,cpy_aopt.s(0),arefnr)
end function

public function optgetconstname(popt as vbaptr,cgroup as long,cindex as long,cname as string) as long
   dim cpy_cname as string255
   optgetconstname = dll_optgetconstname(popt.p,cgroup,cindex,cpy_cname.s(0))
   call convertpas2bas(cpy_cname.s,cname)
end function

public function optgettypename(popt as vbaptr,tnr as long,stname as string) as long
   dim cpy_stname as string255
   optgettypename = dll_optgettypename(popt.p,tnr,cpy_stname.s(0))
   call convertpas2bas(cpy_stname.s,stname)
end function

public function optlookup(popt as vbaptr,aopt as string) as long
   dim cpy_aopt as string255
   call convertbas2pas(aopt, cpy_aopt.s)
   optlookup = dll_optlookup(popt.p,cpy_aopt.s(0))
end function

public sub optreadfrompchar(popt as vbaptr,p as byte)
   call dll_optreadfrompchar(popt.p,p)
end sub

public function optgetnameopt(popt as vbaptr,asval as string,solver as string,opt as long) as long
   dim cpy_asval as string255
   dim cpy_solver as string255
   call convertbas2pas(asval, cpy_asval.s)
   optgetnameopt = dll_optgetnameopt(popt.p,cpy_asval.s(0),cpy_solver.s(0),opt)
   call convertpas2bas(cpy_solver.s,solver)
end function

public function optgetdefinedstr(popt as vbaptr,aname as string) as boolean
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   optgetdefinedstr = dll_optgetdefinedstr(popt.p,cpy_aname.s(0))
end function

public function optgetintstr(popt as vbaptr,aname as string) as long
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   optgetintstr = dll_optgetintstr(popt.p,cpy_aname.s(0))
end function

public function optgetdblstr(popt as vbaptr,aname as string) as double
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   optgetdblstr = dll_optgetdblstr(popt.p,cpy_aname.s(0))
end function

public function optgetstrstr(popt as vbaptr,aname as string) as string
   dim cpy_result(str_len) as byte
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   call dll_optgetstrstr(popt.p,cpy_aname.s(0),cpy_result(0))
   call convertc2bas(cpy_result, optgetstrstr)
end function

public sub optsetintstr(popt as vbaptr,aname as string,aival as long)
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   call dll_optsetintstr(popt.p,cpy_aname.s(0),aival)
end sub

public sub optsetdblstr(popt as vbaptr,aname as string,adval as double)
   dim cpy_aname as string255
   call convertbas2pas(aname, cpy_aname.s)
   call dll_optsetdblstr(popt.p,cpy_aname.s(0),adval)
end sub

public sub optsetstrstr(popt as vbaptr,aname as string,asval as string)
   dim cpy_aname as string255
   dim cpy_asval as string255
   call convertbas2pas(aname, cpy_aname.s)
   call convertbas2pas(asval, cpy_asval.s)
   call dll_optsetstrstr(popt.p,cpy_aname.s(0),cpy_asval.s(0))
end sub

public function optcount(popt as vbaptr) as long
   optcount = dll_optcount(popt.p)
end function

public function optmessagecount(popt as vbaptr) as long
   optmessagecount = dll_optmessagecount(popt.p)
end function

public function optgroupcount(popt as vbaptr) as long
   optgroupcount = dll_optgroupcount(popt.p)
end function

public function optrecentenabled(popt as vbaptr) as long
   optrecentenabled = dll_optrecentenabled(popt.p)
end function

public sub optrecentenabledset(popt as vbaptr, x as long)
   call dll_optrecentenabledset(popt.p,x)
end sub
