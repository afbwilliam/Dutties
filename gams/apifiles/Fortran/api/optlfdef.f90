MODULE optlfdef

  ! Lahey Fortran 95 procedure wrapper generated by apiwrapper for GAMS Version 24.0.2

  IMPLICIT NONE

  ! Constant declarations


  INTEGER(KIND=4),PARAMETER :: optDataNone     = 0 ! optDataType
  INTEGER(KIND=4),PARAMETER :: optDataInteger  = 1
  INTEGER(KIND=4),PARAMETER :: optDataDouble   = 2
  INTEGER(KIND=4),PARAMETER :: optDataString   = 3
  INTEGER(KIND=4),PARAMETER :: optDataStrList  = 4

  INTEGER(KIND=4),PARAMETER :: optTypeInteger    = 0 ! optOptionType
  INTEGER(KIND=4),PARAMETER :: optTypeDouble     = 1
  INTEGER(KIND=4),PARAMETER :: optTypeString     = 2
  INTEGER(KIND=4),PARAMETER :: optTypeBoolean    = 3
  INTEGER(KIND=4),PARAMETER :: optTypeEnumStr    = 4
  INTEGER(KIND=4),PARAMETER :: optTypeEnumInt    = 5
  INTEGER(KIND=4),PARAMETER :: optTypeMultiList  = 6
  INTEGER(KIND=4),PARAMETER :: optTypeStrList    = 7
  INTEGER(KIND=4),PARAMETER :: optTypeMacro      = 8
  INTEGER(KIND=4),PARAMETER :: optTypeImmediate  = 9

  INTEGER(KIND=4),PARAMETER :: optsubRequired  = 0 ! optOptionSubType
  INTEGER(KIND=4),PARAMETER :: optsubNoValue   = 1
  INTEGER(KIND=4),PARAMETER :: optsubOptional  = 2
  INTEGER(KIND=4),PARAMETER :: optsub2Values   = 3

  INTEGER(KIND=4),PARAMETER :: optMsgInputEcho     = 0 ! optMsgType
  INTEGER(KIND=4),PARAMETER :: optMsgHelp          = 1
  INTEGER(KIND=4),PARAMETER :: optMsgDefineError   = 2
  INTEGER(KIND=4),PARAMETER :: optMsgValueError    = 3
  INTEGER(KIND=4),PARAMETER :: optMsgValueWarning  = 4
  INTEGER(KIND=4),PARAMETER :: optMsgDeprecated    = 5
  INTEGER(KIND=4),PARAMETER :: optMsgFileEnter     = 6
  INTEGER(KIND=4),PARAMETER :: optMsgFileLeave     = 7
  INTEGER(KIND=4),PARAMETER :: optMsgTooManyMsgs   = 8
  INTEGER(KIND=4),PARAMETER :: optMsgUserError     = 9

  INTEGER(KIND=4),PARAMETER :: optMapIndicator   = 0 ! optVarEquMapType
  INTEGER(KIND=4),PARAMETER :: optMapDefinedVar  = 1

  INTERFACE
  LOGICAL FUNCTION optCreate(popt, errMsg)
    INTEGER(KIND=4), INTENT(OUT) :: popt
    CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  END FUNCTION
  END INTERFACE

  INTERFACE
  LOGICAL FUNCTION optCreateD(popt, dirName, errMsg)
    INTEGER(KIND=4), INTENT(OUT) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: dirName
    CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  END FUNCTION
  END INTERFACE

  INTERFACE
  LOGICAL FUNCTION optCreateL(popt, libName, errMsg)
    INTEGER(KIND=4), INTENT(OUT) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: libName
    CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  END FUNCTION
  END INTERFACE

  INTERFACE
  LOGICAL FUNCTION optFree(popt)
    INTEGER(KIND=4), INTENT(OUT) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvF2PChar(fstr,pchar)
    CHARACTER(LEN=*) fstr
    CHARACTER(LEN=*) pchar
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvPChar2F(pchar,fstr)
    INTEGER pchar
    CHARACTER(LEN=*) fstr
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvStringPAS2F(passtr,fstr)
    CHARACTER(LEN=*) passtr
    CHARACTER(LEN=*) fstr
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvStringC2F(cstr,fstr)
    CHARACTER(LEN=*) cstr
    CHARACTER(LEN=*) fstr
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvStringF2PAS(fstr,passtr)
    CHARACTER(LEN=*) fstr
    CHARACTER(LEN=*) passtr
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE ConvStringF2C(fstr,cstr)
    CHARACTER(LEN=*) fstr
    CHARACTER(LEN=*) cstr
  END SUBROUTINE
  END INTERFACE


  INTERFACE
  INTEGER(KIND=4) FUNCTION optReadDefinition(popt,fn)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: fn
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optReadParameterFile(popt,fn)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: fn
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optReadFromStr(popt,s)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: s
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optWriteParameterFile(popt,fn)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: fn
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optClearMessages(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optAddMessage(popt,info)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: info
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optGetMessage(popt,NrMsg,info,iType)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: NrMsg
    CHARACTER(LEN=*), INTENT(OUT) :: info
    INTEGER(KIND=4), INTENT(OUT) :: iType
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optResetAll(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optResetAllRecent(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optResetRecentChanges(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optShowHelp(popt,HlpID)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: HlpID
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optResetNr(popt,ANr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optFindStr(popt,AName,ANr,ARefNr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    INTEGER(KIND=4), INTENT(OUT) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: ARefNr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetInfoNr(popt,ANr,ADefined,ADefinedR, &
         ARefNr,ADataType,AOptType,ASubType)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: ADefined
    INTEGER(KIND=4), INTENT(OUT) :: ADefinedR
    INTEGER(KIND=4), INTENT(OUT) :: ARefNr
    INTEGER(KIND=4), INTENT(OUT) :: ADataType
    INTEGER(KIND=4), INTENT(OUT) :: AOptType
    INTEGER(KIND=4), INTENT(OUT) :: ASubType
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetValuesNr(popt,ANr,ASName,AIVal,ADVal, &
         ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASName
    INTEGER(KIND=4), INTENT(OUT) :: AIVal
    REAL(KIND=8), INTENT(OUT) :: ADVal
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetValuesNr(popt,ANr,AIVal,ADVal,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AIVal
    REAL(KIND=8), INTENT(IN) :: ADVal
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetValues2Nr(popt,ANr,AIVal,ADVal,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AIVal
    REAL(KIND=8), INTENT(IN) :: ADVal
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optVersion(popt,sversion)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(OUT) :: sversion
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optDefinitionFile(popt,sfilename)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(OUT) :: sfilename
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetFromAnyStrList(popt,idash,skey,sval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: idash
    CHARACTER(LEN=*), INTENT(OUT) :: skey
    CHARACTER(LEN=*), INTENT(OUT) :: sval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetFromListStr(popt,skey,sval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: skey
    CHARACTER(LEN=*), INTENT(OUT) :: sval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optListCountStr(popt,skey)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: skey
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optReadFromListStr(popt,skey,iPos,sval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: skey
    INTEGER(KIND=4), INTENT(IN) :: iPos
    CHARACTER(LEN=*), INTENT(OUT) :: sval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSynonymCount(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetSynonym(popt,NrSyn,SSyn,SName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: NrSyn
    CHARACTER(LEN=*), INTENT(OUT) :: SSyn
    CHARACTER(LEN=*), INTENT(OUT) :: SName
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optEchoSet(popt,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optEOLOnlySet(popt,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optNoBoundsSet(popt,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optErrorCount(popt,iErrors,iWarnings)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(OUT) :: iErrors
    INTEGER(KIND=4), INTENT(OUT) :: iWarnings
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetBoundsInt(popt,ANr,ilval,ihval,idval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: ilval
    INTEGER(KIND=4), INTENT(OUT) :: ihval
    INTEGER(KIND=4), INTENT(OUT) :: idval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetBoundsDbl(popt,ANr,dlval,dhval,ddval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    REAL(KIND=8), INTENT(OUT) :: dlval
    REAL(KIND=8), INTENT(OUT) :: dhval
    REAL(KIND=8), INTENT(OUT) :: ddval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDefaultStr(popt,ANr,sval)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: sval
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetIntNr(popt,ANr,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetInt2Nr(popt,ANr,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetIntNr(popt,ANr,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetInt2Nr(popt,ANr,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetStrNr(popt,ANr,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetOptHelpNr(popt,ANr,AName,AHc,AGroup)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: AName
    INTEGER(KIND=4), INTENT(OUT) :: AHc
    INTEGER(KIND=4), INTENT(OUT) :: AGroup
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEnumHelp(popt,ANr,AOrd,AHc,AHelpStr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AOrd
    INTEGER(KIND=4), INTENT(OUT) :: AHc
    CHARACTER(LEN=*), INTENT(OUT) :: AHelpStr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEnumStrNr(popt,ANr,ASVal,AOrd)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
    INTEGER(KIND=4), INTENT(OUT) :: AOrd
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEnumCount(popt,ANr,ACount)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: ACount
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEnumValue(popt,ANr,AOrd,AValInt, &
         AValStr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: AOrd
    INTEGER(KIND=4), INTENT(OUT) :: AValInt
    CHARACTER(LEN=*), INTENT(OUT) :: AValStr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetStr2Nr(popt,ANr,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetStrNr(popt,ANr,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetStr2Nr(popt,ANr,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDblNr(popt,ANr,ADVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    REAL(KIND=8), INTENT(OUT) :: ADVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDbl2Nr(popt,ANr,ADVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    REAL(KIND=8), INTENT(OUT) :: ADVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetDblNr(popt,ANr,ADVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    REAL(KIND=8), INTENT(IN) :: ADVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetDbl2Nr(popt,ANr,ADVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    REAL(KIND=8), INTENT(IN) :: ADVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetValStr(popt,AName,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetVal2Str(popt,AName,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetNameNr(popt,ANr,ASName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASName
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDefinedNr(popt,ANr,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(OUT) :: AIVal
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetHelpNr(popt,ANr,ASOpt,ASHelp)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: ASOpt
    CHARACTER(LEN=*), INTENT(OUT) :: ASHelp
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetGroupNr(popt,ANr,AName,AGroup,AHc, &
         AHelp)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: AName
    INTEGER(KIND=4), INTENT(OUT) :: AGroup
    INTEGER(KIND=4), INTENT(OUT) :: AHc
    CHARACTER(LEN=*), INTENT(OUT) :: AHelp
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetGroupGrpNr(popt,AGroup)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: AGroup
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetOptGroupNr(popt,ANr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDotOptNr(popt,ANr,VEName,AObjNr, &
         ADim,AValue)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: VEName
    INTEGER(KIND=4), INTENT(OUT) :: AObjNr
    INTEGER(KIND=4), INTENT(OUT) :: ADim
    REAL(KIND=8), INTENT(OUT) :: AValue
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetDotOptUel(popt,ANr,ADim,AUEL)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ADim
    CHARACTER(LEN=*), INTENT(OUT) :: AUEL
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetVarEquMapNr(popt,maptype,ANr,EquName, &
         VarName,EquDim,VarDim,AValue)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: maptype
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: EquName
    CHARACTER(LEN=*), INTENT(OUT) :: VarName
    INTEGER(KIND=4), INTENT(OUT) :: EquDim
    INTEGER(KIND=4), INTENT(OUT) :: VarDim
    INTEGER(KIND=4), INTENT(OUT) :: AValue
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEquVarEquMapNr(popt,maptype,ANr, &
         ADim,AIndex)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: maptype
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ADim
    CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetVarVarEquMapNr(popt,maptype,ANr, &
         ADim,AIndex)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: maptype
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ADim
    CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optVarEquMapCount(popt,maptype,ANrErrors)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: maptype
    INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetIndicatorNr(popt,ANr,EquName,VarName, &
         EquDim,VarDim,AValue)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    CHARACTER(LEN=*), INTENT(OUT) :: EquName
    CHARACTER(LEN=*), INTENT(OUT) :: VarName
    INTEGER(KIND=4), INTENT(OUT) :: EquDim
    INTEGER(KIND=4), INTENT(OUT) :: VarDim
    INTEGER(KIND=4), INTENT(OUT) :: AValue
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetEquIndicatorNr(popt,ANr,ADim,AIndex)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ADim
    CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetVarIndicatorNr(popt,ANr,ADim,AIndex)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ADim
    CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optIndicatorCount(popt,ANrErrors)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optDotOptCount(popt,ANrErrors)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetRefNr(popt,ANr,ARefNr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: ANr
    INTEGER(KIND=4), INTENT(IN) :: ARefNr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optSetRefNrStr(popt,AOpt,ARefNr)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AOpt
    INTEGER(KIND=4), INTENT(IN) :: ARefNr
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetConstName(popt,cgroup,cindex,cname)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: cgroup
    INTEGER(KIND=4), INTENT(IN) :: cindex
    CHARACTER(LEN=*), INTENT(OUT) :: cname
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetTypeName(popt,TNr,sTName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: TNr
    CHARACTER(LEN=*), INTENT(OUT) :: sTName
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optLookUp(popt,AOpt)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AOpt
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optReadFromPChar(popt,p)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN OUT) :: p
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetNameOpt(popt,ASVal,solver,opt)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
    CHARACTER(LEN=*), INTENT(OUT) :: solver
    INTEGER(KIND=4), INTENT(OUT) :: opt
  END FUNCTION
  END INTERFACE

  INTERFACE
  LOGICAL FUNCTION optGetDefinedStr(popt,AName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGetIntStr(popt,AName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
  END FUNCTION
  END INTERFACE

  INTERFACE
  REAL(KIND=8) FUNCTION optGetDblStr(popt,AName)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optSetIntStr(popt,AName,AIVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    INTEGER(KIND=4), INTENT(IN) :: AIVal
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optSetDblStr(popt,AName,ADVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    REAL(KIND=8), INTENT(IN) :: ADVal
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  SUBROUTINE optSetStrStr(popt,AName,ASVal)
    INTEGER(KIND=4), INTENT(IN) :: popt
    CHARACTER(LEN=*), INTENT(IN) :: AName
    CHARACTER(LEN=*), INTENT(IN) :: ASVal
  END SUBROUTINE
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optCount(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optMessageCount(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optGroupCount(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  INTEGER(KIND=4) FUNCTION optRecentEnabled(popt)
    INTEGER(KIND=4), INTENT(IN) :: popt
  END FUNCTION
  END INTERFACE

  INTERFACE
  SUBROUTINE optRecentEnabledSet(popt,x)
    INTEGER(KIND=4), INTENT(IN) :: popt
    INTEGER(KIND=4), INTENT(IN) :: x
  END SUBROUTINE
  END INTERFACE

END MODULE optlfdef

LOGICAL FUNCTION optCreate(popt, errMsg)
  INTEGER(KIND=4), INTENT(OUT) :: popt
  CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  ML_EXTERNAL xcreate_
  CALL xcreate_(popt)
  optCreate = .TRUE.
END FUNCTION

LOGICAL FUNCTION optCreateD(popt, dirName, errMsg)
  INTEGER(KIND=4), INTENT(OUT) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: dirName
  CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  ML_EXTERNAL xcreate_
  CALL xcreate_(popt)
  optCreateD = .TRUE.
END FUNCTION

LOGICAL FUNCTION optCreateL(popt, libName, errMsg)
  INTEGER(KIND=4), INTENT(OUT) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: libName
  CHARACTER(LEN=*), INTENT(OUT) :: errMsg
  ML_EXTERNAL xcreate_
  CALL xcreate_(popt)
  optCreateL = .TRUE.
END FUNCTION

LOGICAL FUNCTION optFree(popt)
  INTEGER(KIND=4), INTENT(OUT) :: popt
  ML_EXTERNAL xfree_
  CALL xfree_(popt)
  optFree = .TRUE.
END FUNCTION

SUBROUTINE ConvF2PChar(fstr,pchar)
  IMPLICIT NONE
  CHARACTER(LEN=*) fstr
  CHARACTER(LEN=*) pchar
  INTEGER n
  n = LEN_TRIM(fstr)
  pchar(1:n) = fstr(1:n)
  pchar(n+1:n+1) = char(0)
END SUBROUTINE

SUBROUTINE ConvPChar2F(pchar,fstr)
  IMPLICIT NONE
  INTEGER pchar
  CHARACTER(LEN=*) fstr
  INTEGER n
  INTEGER i
  CHARACTER c
  POINTER(p,c)
  n = LEN(fstr)
  fstr = ' '
  DO i=1,n
    p = pchar+i-1
    IF (ICHAR(c)==0) RETURN
    fstr(i:i) = c
  END DO
END SUBROUTINE

SUBROUTINE ConvStringPAS2F(passtr,fstr)
  IMPLICIT NONE
  CHARACTER(LEN=*) passtr
  CHARACTER(LEN=*) fstr
  INTEGER n
  n = ICHAR(passtr(1:1))
  IF (n>LEN(passtr)-1) THEN
    n = LEN(passtr)-1
  END IF
  IF (n>LEN(fstr)) THEN
    n = LEN(fstr)
  END IF
  fstr = ' '
  fstr(1:n) = passtr(2:n+1)
END SUBROUTINE

SUBROUTINE ConvStringC2F(cstr,fstr)
  IMPLICIT NONE
  CHARACTER(LEN=*) cstr
  CHARACTER(LEN=*) fstr
  INTEGER n
  fstr = ' '
  n = INDEX(cstr,char(0))
  IF (n==0) THEN
    fstr = cstr
  ELSE
    fstr(1:n-1) = cstr(1:n-1)
  END IF
END SUBROUTINE

SUBROUTINE ConvStringF2PAS(fstr,passtr)
  IMPLICIT NONE
  CHARACTER(LEN=*) fstr
  CHARACTER(LEN=*) passtr
  INTEGER n
  n = LEN_TRIM(fstr)
  IF (n>LEN(passtr)-1) THEN
    n = LEN(passtr)-1
  END IF
  passtr(1:1) = CHAR(n)
  passtr(2:n+1) = fstr(1:n)
END SUBROUTINE

SUBROUTINE ConvStringF2C(fstr,cstr)
  IMPLICIT NONE
  CHARACTER(LEN=*) fstr
  CHARACTER(LEN=*) cstr
  INTEGER n
  cstr=' '
  n = 1+LEN_TRIM(fstr)
  IF (n>LEN(cstr)) n = LEN(cstr)
  cstr=fstr
  cstr(n:n)=CHAR(0)
END SUBROUTINE


INTEGER(KIND=4) FUNCTION optReadDefinition(popt,fn)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: fn
  CHARACTER(LEN=256) :: cpy_fn
  ML_EXTERNAL optreaddefinition_
  INTEGER(KIND=4) optReadDefinition_
  CALL ConvStringF2PAS(fn, cpy_fn)
  optReadDefinition = optReadDefinition_(val(popt), cpy_fn)
END FUNCTION

INTEGER(KIND=4) FUNCTION optReadParameterFile(popt,fn)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: fn
  CHARACTER(LEN=256) :: cpy_fn
  ML_EXTERNAL optreadparameterfile_
  INTEGER(KIND=4) optReadParameterFile_
  CALL ConvStringF2PAS(fn, cpy_fn)
  optReadParameterFile = optReadParameterFile_(val(popt), cpy_fn)
END FUNCTION

SUBROUTINE optReadFromStr(popt,s)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: s
  CHARACTER(LEN=256) :: cpy_s
  ML_EXTERNAL optreadfromstr_
  CALL ConvStringF2PAS(s, cpy_s)
  CALL optReadFromStr_(val(popt), cpy_s)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optWriteParameterFile(popt,fn)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: fn
  CHARACTER(LEN=256) :: cpy_fn
  ML_EXTERNAL optwriteparameterfile_
  INTEGER(KIND=4) optWriteParameterFile_
  CALL ConvStringF2PAS(fn, cpy_fn)
  optWriteParameterFile = optWriteParameterFile_(val(popt), cpy_fn)
END FUNCTION

SUBROUTINE optClearMessages(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optclearmessages_
  CALL optClearMessages_(val(popt))
END SUBROUTINE

SUBROUTINE optAddMessage(popt,info)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: info
  CHARACTER(LEN=256) :: cpy_info
  ML_EXTERNAL optaddmessage_
  CALL ConvStringF2PAS(info, cpy_info)
  CALL optAddMessage_(val(popt), cpy_info)
END SUBROUTINE

SUBROUTINE optGetMessage(popt,NrMsg,info,iType)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: NrMsg
  CHARACTER(LEN=*), INTENT(OUT) :: info
  CHARACTER(LEN=256) :: cpy_info
  INTEGER(KIND=4), INTENT(OUT) :: iType
  ML_EXTERNAL optgetmessage_
  CALL optGetMessage_(val(popt), val(NrMsg), cpy_info, iType)
  CALL ConvStringPAS2F(cpy_info, info)
END SUBROUTINE

SUBROUTINE optResetAll(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optresetall_
  CALL optResetAll_(val(popt))
END SUBROUTINE

SUBROUTINE optResetAllRecent(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optresetallrecent_
  CALL optResetAllRecent_(val(popt))
END SUBROUTINE

SUBROUTINE optResetRecentChanges(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optresetrecentchanges_
  CALL optResetRecentChanges_(val(popt))
END SUBROUTINE

SUBROUTINE optShowHelp(popt,HlpID)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: HlpID
  CHARACTER(LEN=256) :: cpy_HlpID
  ML_EXTERNAL optshowhelp_
  CALL ConvStringF2PAS(HlpID, cpy_HlpID)
  CALL optShowHelp_(val(popt), cpy_HlpID)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optResetNr(popt,ANr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  ML_EXTERNAL optresetnr_
  INTEGER(KIND=4) optResetNr_
  optResetNr = optResetNr_(val(popt), val(ANr))
END FUNCTION

INTEGER(KIND=4) FUNCTION optFindStr(popt,AName,ANr,ARefNr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  INTEGER(KIND=4), INTENT(OUT) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: ARefNr
  ML_EXTERNAL optfindstr_
  INTEGER(KIND=4) optFindStr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optFindStr = optFindStr_(val(popt), cpy_AName, ANr, ARefNr)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetInfoNr(popt,ANr,ADefined,ADefinedR, &
         ARefNr,ADataType,AOptType,ASubType)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: ADefined
  INTEGER(KIND=4), INTENT(OUT) :: ADefinedR
  INTEGER(KIND=4), INTENT(OUT) :: ARefNr
  INTEGER(KIND=4), INTENT(OUT) :: ADataType
  INTEGER(KIND=4), INTENT(OUT) :: AOptType
  INTEGER(KIND=4), INTENT(OUT) :: ASubType
  ML_EXTERNAL optgetinfonr_
  INTEGER(KIND=4) optGetInfoNr_
  optGetInfoNr = optGetInfoNr_(val(popt), val(ANr), ADefined, ADefinedR &
         , ARefNr, ADataType, AOptType, ASubType)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetValuesNr(popt,ANr,ASName,AIVal,ADVal, &
         ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASName
  CHARACTER(LEN=256) :: cpy_ASName
  INTEGER(KIND=4), INTENT(OUT) :: AIVal
  REAL(KIND=8), INTENT(OUT) :: ADVal
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optgetvaluesnr_
  INTEGER(KIND=4) optGetValuesNr_
  optGetValuesNr = optGetValuesNr_(val(popt), val(ANr), cpy_ASName &
         , AIVal, ADVal, cpy_ASVal)
  CALL ConvStringPAS2F(cpy_ASName, ASName)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetValuesNr(popt,ANr,AIVal,ADVal,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  REAL(KIND=8), INTENT(IN) :: ADVal
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optsetvaluesnr_
  INTEGER(KIND=4) optSetValuesNr_
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  optSetValuesNr = optSetValuesNr_(val(popt), val(ANr), val(AIVal) &
         , val(ADVal), cpy_ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetValues2Nr(popt,ANr,AIVal,ADVal,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  REAL(KIND=8), INTENT(IN) :: ADVal
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optsetvalues2nr_
  INTEGER(KIND=4) optSetValues2Nr_
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  optSetValues2Nr = optSetValues2Nr_(val(popt), val(ANr), val(AIVal) &
         , val(ADVal), cpy_ASVal)
END FUNCTION

SUBROUTINE optVersion(popt,sversion)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(OUT) :: sversion
  CHARACTER(LEN=256) :: cpy_sversion
  ML_EXTERNAL optversion_
  CALL optVersion_(val(popt), cpy_sversion)
  CALL ConvStringPAS2F(cpy_sversion, sversion)
END SUBROUTINE

SUBROUTINE optDefinitionFile(popt,sfilename)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(OUT) :: sfilename
  CHARACTER(LEN=256) :: cpy_sfilename
  ML_EXTERNAL optdefinitionfile_
  CALL optDefinitionFile_(val(popt), cpy_sfilename)
  CALL ConvStringPAS2F(cpy_sfilename, sfilename)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optGetFromAnyStrList(popt,idash,skey,sval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: idash
  CHARACTER(LEN=*), INTENT(OUT) :: skey
  CHARACTER(LEN=256) :: cpy_skey
  CHARACTER(LEN=*), INTENT(OUT) :: sval
  CHARACTER(LEN=256) :: cpy_sval
  ML_EXTERNAL optgetfromanystrlist_
  INTEGER(KIND=4) optGetFromAnyStrList_
  optGetFromAnyStrList = optGetFromAnyStrList_(val(popt), val(idash) &
         , cpy_skey, cpy_sval)
  CALL ConvStringPAS2F(cpy_skey, skey)
  CALL ConvStringPAS2F(cpy_sval, sval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetFromListStr(popt,skey,sval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: skey
  CHARACTER(LEN=256) :: cpy_skey
  CHARACTER(LEN=*), INTENT(OUT) :: sval
  CHARACTER(LEN=256) :: cpy_sval
  ML_EXTERNAL optgetfromliststr_
  INTEGER(KIND=4) optGetFromListStr_
  CALL ConvStringF2PAS(skey, cpy_skey)
  optGetFromListStr = optGetFromListStr_(val(popt), cpy_skey, cpy_sval)
  CALL ConvStringPAS2F(cpy_sval, sval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optListCountStr(popt,skey)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: skey
  CHARACTER(LEN=256) :: cpy_skey
  ML_EXTERNAL optlistcountstr_
  INTEGER(KIND=4) optListCountStr_
  CALL ConvStringF2PAS(skey, cpy_skey)
  optListCountStr = optListCountStr_(val(popt), cpy_skey)
END FUNCTION

INTEGER(KIND=4) FUNCTION optReadFromListStr(popt,skey,iPos,sval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: skey
  CHARACTER(LEN=256) :: cpy_skey
  INTEGER(KIND=4), INTENT(IN) :: iPos
  CHARACTER(LEN=*), INTENT(OUT) :: sval
  CHARACTER(LEN=256) :: cpy_sval
  ML_EXTERNAL optreadfromliststr_
  INTEGER(KIND=4) optReadFromListStr_
  CALL ConvStringF2PAS(skey, cpy_skey)
  optReadFromListStr = optReadFromListStr_(val(popt), cpy_skey, val(iPos) &
         , cpy_sval)
  CALL ConvStringPAS2F(cpy_sval, sval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSynonymCount(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optsynonymcount_
  INTEGER(KIND=4) optSynonymCount_
  optSynonymCount = optSynonymCount_(val(popt))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetSynonym(popt,NrSyn,SSyn,SName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: NrSyn
  CHARACTER(LEN=*), INTENT(OUT) :: SSyn
  CHARACTER(LEN=256) :: cpy_SSyn
  CHARACTER(LEN=*), INTENT(OUT) :: SName
  CHARACTER(LEN=256) :: cpy_SName
  ML_EXTERNAL optgetsynonym_
  INTEGER(KIND=4) optGetSynonym_
  optGetSynonym = optGetSynonym_(val(popt), val(NrSyn), cpy_SSyn, cpy_SName)
  CALL ConvStringPAS2F(cpy_SSyn, SSyn)
  CALL ConvStringPAS2F(cpy_SName, SName)
END FUNCTION

SUBROUTINE optEchoSet(popt,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL optechoset_
  CALL optEchoSet_(val(popt), val(AIVal))
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optEOLOnlySet(popt,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL opteolonlyset_
  INTEGER(KIND=4) optEOLOnlySet_
  optEOLOnlySet = optEOLOnlySet_(val(popt), val(AIVal))
END FUNCTION

SUBROUTINE optNoBoundsSet(popt,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL optnoboundsset_
  CALL optNoBoundsSet_(val(popt), val(AIVal))
END SUBROUTINE

SUBROUTINE optErrorCount(popt,iErrors,iWarnings)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(OUT) :: iErrors
  INTEGER(KIND=4), INTENT(OUT) :: iWarnings
  ML_EXTERNAL opterrorcount_
  CALL optErrorCount_(val(popt), iErrors, iWarnings)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optGetBoundsInt(popt,ANr,ilval,ihval,idval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: ilval
  INTEGER(KIND=4), INTENT(OUT) :: ihval
  INTEGER(KIND=4), INTENT(OUT) :: idval
  ML_EXTERNAL optgetboundsint_
  INTEGER(KIND=4) optGetBoundsInt_
  optGetBoundsInt = optGetBoundsInt_(val(popt), val(ANr), ilval, ihval &
         , idval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetBoundsDbl(popt,ANr,dlval,dhval,ddval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  REAL(KIND=8), INTENT(OUT) :: dlval
  REAL(KIND=8), INTENT(OUT) :: dhval
  REAL(KIND=8), INTENT(OUT) :: ddval
  ML_EXTERNAL optgetboundsdbl_
  INTEGER(KIND=4) optGetBoundsDbl_
  optGetBoundsDbl = optGetBoundsDbl_(val(popt), val(ANr), dlval, dhval &
         , ddval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDefaultStr(popt,ANr,sval)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: sval
  CHARACTER(LEN=256) :: cpy_sval
  ML_EXTERNAL optgetdefaultstr_
  INTEGER(KIND=4) optGetDefaultStr_
  optGetDefaultStr = optGetDefaultStr_(val(popt), val(ANr), cpy_sval)
  CALL ConvStringPAS2F(cpy_sval, sval)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetIntNr(popt,ANr,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: AIVal
  ML_EXTERNAL optgetintnr_
  INTEGER(KIND=4) optGetIntNr_
  optGetIntNr = optGetIntNr_(val(popt), val(ANr), AIVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetInt2Nr(popt,ANr,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: AIVal
  ML_EXTERNAL optgetint2nr_
  INTEGER(KIND=4) optGetInt2Nr_
  optGetInt2Nr = optGetInt2Nr_(val(popt), val(ANr), AIVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetIntNr(popt,ANr,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL optsetintnr_
  INTEGER(KIND=4) optSetIntNr_
  optSetIntNr = optSetIntNr_(val(popt), val(ANr), val(AIVal))
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetInt2Nr(popt,ANr,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL optsetint2nr_
  INTEGER(KIND=4) optSetInt2Nr_
  optSetInt2Nr = optSetInt2Nr_(val(popt), val(ANr), val(AIVal))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetStrNr(popt,ANr,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optgetstrnr_
  INTEGER(KIND=4) optGetStrNr_
  optGetStrNr = optGetStrNr_(val(popt), val(ANr), cpy_ASVal)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetOptHelpNr(popt,ANr,AName,AHc,AGroup)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  INTEGER(KIND=4), INTENT(OUT) :: AHc
  INTEGER(KIND=4), INTENT(OUT) :: AGroup
  ML_EXTERNAL optgetopthelpnr_
  INTEGER(KIND=4) optGetOptHelpNr_
  optGetOptHelpNr = optGetOptHelpNr_(val(popt), val(ANr), cpy_AName &
         , AHc, AGroup)
  CALL ConvStringPAS2F(cpy_AName, AName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEnumHelp(popt,ANr,AOrd,AHc,AHelpStr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AOrd
  INTEGER(KIND=4), INTENT(OUT) :: AHc
  CHARACTER(LEN=*), INTENT(OUT) :: AHelpStr
  CHARACTER(LEN=256) :: cpy_AHelpStr
  ML_EXTERNAL optgetenumhelp_
  INTEGER(KIND=4) optGetEnumHelp_
  optGetEnumHelp = optGetEnumHelp_(val(popt), val(ANr), val(AOrd) &
         , AHc, cpy_AHelpStr)
  CALL ConvStringPAS2F(cpy_AHelpStr, AHelpStr)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEnumStrNr(popt,ANr,ASVal,AOrd)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  INTEGER(KIND=4), INTENT(OUT) :: AOrd
  ML_EXTERNAL optgetenumstrnr_
  INTEGER(KIND=4) optGetEnumStrNr_
  optGetEnumStrNr = optGetEnumStrNr_(val(popt), val(ANr), cpy_ASVal &
         , AOrd)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEnumCount(popt,ANr,ACount)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: ACount
  ML_EXTERNAL optgetenumcount_
  INTEGER(KIND=4) optGetEnumCount_
  optGetEnumCount = optGetEnumCount_(val(popt), val(ANr), ACount)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEnumValue(popt,ANr,AOrd,AValInt,AValStr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: AOrd
  INTEGER(KIND=4), INTENT(OUT) :: AValInt
  CHARACTER(LEN=*), INTENT(OUT) :: AValStr
  CHARACTER(LEN=256) :: cpy_AValStr
  ML_EXTERNAL optgetenumvalue_
  INTEGER(KIND=4) optGetEnumValue_
  optGetEnumValue = optGetEnumValue_(val(popt), val(ANr), val(AOrd) &
         , AValInt, cpy_AValStr)
  CALL ConvStringPAS2F(cpy_AValStr, AValStr)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetStr2Nr(popt,ANr,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optgetstr2nr_
  INTEGER(KIND=4) optGetStr2Nr_
  optGetStr2Nr = optGetStr2Nr_(val(popt), val(ANr), cpy_ASVal)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetStrNr(popt,ANr,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optsetstrnr_
  INTEGER(KIND=4) optSetStrNr_
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  optSetStrNr = optSetStrNr_(val(popt), val(ANr), cpy_ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetStr2Nr(popt,ANr,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optsetstr2nr_
  INTEGER(KIND=4) optSetStr2Nr_
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  optSetStr2Nr = optSetStr2Nr_(val(popt), val(ANr), cpy_ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDblNr(popt,ANr,ADVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  REAL(KIND=8), INTENT(OUT) :: ADVal
  ML_EXTERNAL optgetdblnr_
  INTEGER(KIND=4) optGetDblNr_
  optGetDblNr = optGetDblNr_(val(popt), val(ANr), ADVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDbl2Nr(popt,ANr,ADVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  REAL(KIND=8), INTENT(OUT) :: ADVal
  ML_EXTERNAL optgetdbl2nr_
  INTEGER(KIND=4) optGetDbl2Nr_
  optGetDbl2Nr = optGetDbl2Nr_(val(popt), val(ANr), ADVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetDblNr(popt,ANr,ADVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  REAL(KIND=8), INTENT(IN) :: ADVal
  ML_EXTERNAL optsetdblnr_
  INTEGER(KIND=4) optSetDblNr_
  optSetDblNr = optSetDblNr_(val(popt), val(ANr), val(ADVal))
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetDbl2Nr(popt,ANr,ADVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  REAL(KIND=8), INTENT(IN) :: ADVal
  ML_EXTERNAL optsetdbl2nr_
  INTEGER(KIND=4) optSetDbl2Nr_
  optSetDbl2Nr = optSetDbl2Nr_(val(popt), val(ANr), val(ADVal))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetValStr(popt,AName,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optgetvalstr_
  INTEGER(KIND=4) optGetValStr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optGetValStr = optGetValStr_(val(popt), cpy_AName, cpy_ASVal)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetVal2Str(popt,AName,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  CHARACTER(LEN=*), INTENT(OUT) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optgetval2str_
  INTEGER(KIND=4) optGetVal2Str_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optGetVal2Str = optGetVal2Str_(val(popt), cpy_AName, cpy_ASVal)
  CALL ConvStringPAS2F(cpy_ASVal, ASVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetNameNr(popt,ANr,ASName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASName
  CHARACTER(LEN=256) :: cpy_ASName
  ML_EXTERNAL optgetnamenr_
  INTEGER(KIND=4) optGetNameNr_
  optGetNameNr = optGetNameNr_(val(popt), val(ANr), cpy_ASName)
  CALL ConvStringPAS2F(cpy_ASName, ASName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDefinedNr(popt,ANr,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(OUT) :: AIVal
  ML_EXTERNAL optgetdefinednr_
  INTEGER(KIND=4) optGetDefinedNr_
  optGetDefinedNr = optGetDefinedNr_(val(popt), val(ANr), AIVal)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetHelpNr(popt,ANr,ASOpt,ASHelp)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: ASOpt
  CHARACTER(LEN=256) :: cpy_ASOpt
  CHARACTER(LEN=*), INTENT(OUT) :: ASHelp
  CHARACTER(LEN=256) :: cpy_ASHelp
  ML_EXTERNAL optgethelpnr_
  INTEGER(KIND=4) optGetHelpNr_
  optGetHelpNr = optGetHelpNr_(val(popt), val(ANr), cpy_ASOpt, cpy_ASHelp)
  CALL ConvStringPAS2F(cpy_ASOpt, ASOpt)
  CALL ConvStringPAS2F(cpy_ASHelp, ASHelp)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetGroupNr(popt,ANr,AName,AGroup,AHc, &
         AHelp)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  INTEGER(KIND=4), INTENT(OUT) :: AGroup
  INTEGER(KIND=4), INTENT(OUT) :: AHc
  CHARACTER(LEN=*), INTENT(OUT) :: AHelp
  CHARACTER(LEN=256) :: cpy_AHelp
  ML_EXTERNAL optgetgroupnr_
  INTEGER(KIND=4) optGetGroupNr_
  optGetGroupNr = optGetGroupNr_(val(popt), val(ANr), cpy_AName, AGroup &
         , AHc, cpy_AHelp)
  CALL ConvStringPAS2F(cpy_AName, AName)
  CALL ConvStringPAS2F(cpy_AHelp, AHelp)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetGroupGrpNr(popt,AGroup)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: AGroup
  ML_EXTERNAL optgetgroupgrpnr_
  INTEGER(KIND=4) optGetGroupGrpNr_
  optGetGroupGrpNr = optGetGroupGrpNr_(val(popt), val(AGroup))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetOptGroupNr(popt,ANr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  ML_EXTERNAL optgetoptgroupnr_
  INTEGER(KIND=4) optGetOptGroupNr_
  optGetOptGroupNr = optGetOptGroupNr_(val(popt), val(ANr))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDotOptNr(popt,ANr,VEName,AObjNr,ADim, &
         AValue)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: VEName
  CHARACTER(LEN=256) :: cpy_VEName
  INTEGER(KIND=4), INTENT(OUT) :: AObjNr
  INTEGER(KIND=4), INTENT(OUT) :: ADim
  REAL(KIND=8), INTENT(OUT) :: AValue
  ML_EXTERNAL optgetdotoptnr_
  INTEGER(KIND=4) optGetDotOptNr_
  optGetDotOptNr = optGetDotOptNr_(val(popt), val(ANr), cpy_VEName &
         , AObjNr, ADim, AValue)
  CALL ConvStringPAS2F(cpy_VEName, VEName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetDotOptUel(popt,ANr,ADim,AUEL)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ADim
  CHARACTER(LEN=*), INTENT(OUT) :: AUEL
  CHARACTER(LEN=256) :: cpy_AUEL
  ML_EXTERNAL optgetdotoptuel_
  INTEGER(KIND=4) optGetDotOptUel_
  optGetDotOptUel = optGetDotOptUel_(val(popt), val(ANr), val(ADim) &
         , cpy_AUEL)
  CALL ConvStringPAS2F(cpy_AUEL, AUEL)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetVarEquMapNr(popt,maptype,ANr,EquName, &
         VarName,EquDim,VarDim,AValue)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: maptype
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: EquName
  CHARACTER(LEN=256) :: cpy_EquName
  CHARACTER(LEN=*), INTENT(OUT) :: VarName
  CHARACTER(LEN=256) :: cpy_VarName
  INTEGER(KIND=4), INTENT(OUT) :: EquDim
  INTEGER(KIND=4), INTENT(OUT) :: VarDim
  INTEGER(KIND=4), INTENT(OUT) :: AValue
  ML_EXTERNAL optgetvarequmapnr_
  INTEGER(KIND=4) optGetVarEquMapNr_
  optGetVarEquMapNr = optGetVarEquMapNr_(val(popt), val(maptype), val(ANr) &
         , cpy_EquName, cpy_VarName, EquDim, VarDim, AValue)
  CALL ConvStringPAS2F(cpy_EquName, EquName)
  CALL ConvStringPAS2F(cpy_VarName, VarName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEquVarEquMapNr(popt,maptype,ANr,ADim, &
         AIndex)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: maptype
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ADim
  CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  CHARACTER(LEN=256) :: cpy_AIndex
  ML_EXTERNAL optgetequvarequmapnr_
  INTEGER(KIND=4) optGetEquVarEquMapNr_
  optGetEquVarEquMapNr = optGetEquVarEquMapNr_(val(popt), val(maptype) &
         , val(ANr), val(ADim), cpy_AIndex)
  CALL ConvStringPAS2F(cpy_AIndex, AIndex)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetVarVarEquMapNr(popt,maptype,ANr,ADim, &
         AIndex)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: maptype
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ADim
  CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  CHARACTER(LEN=256) :: cpy_AIndex
  ML_EXTERNAL optgetvarvarequmapnr_
  INTEGER(KIND=4) optGetVarVarEquMapNr_
  optGetVarVarEquMapNr = optGetVarVarEquMapNr_(val(popt), val(maptype) &
         , val(ANr), val(ADim), cpy_AIndex)
  CALL ConvStringPAS2F(cpy_AIndex, AIndex)
END FUNCTION

INTEGER(KIND=4) FUNCTION optVarEquMapCount(popt,maptype,ANrErrors)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: maptype
  INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  ML_EXTERNAL optvarequmapcount_
  INTEGER(KIND=4) optVarEquMapCount_
  optVarEquMapCount = optVarEquMapCount_(val(popt), val(maptype), ANrErrors)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetIndicatorNr(popt,ANr,EquName,VarName, &
         EquDim,VarDim,AValue)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  CHARACTER(LEN=*), INTENT(OUT) :: EquName
  CHARACTER(LEN=256) :: cpy_EquName
  CHARACTER(LEN=*), INTENT(OUT) :: VarName
  CHARACTER(LEN=256) :: cpy_VarName
  INTEGER(KIND=4), INTENT(OUT) :: EquDim
  INTEGER(KIND=4), INTENT(OUT) :: VarDim
  INTEGER(KIND=4), INTENT(OUT) :: AValue
  ML_EXTERNAL optgetindicatornr_
  INTEGER(KIND=4) optGetIndicatorNr_
  optGetIndicatorNr = optGetIndicatorNr_(val(popt), val(ANr), cpy_EquName &
         , cpy_VarName, EquDim, VarDim, AValue)
  CALL ConvStringPAS2F(cpy_EquName, EquName)
  CALL ConvStringPAS2F(cpy_VarName, VarName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetEquIndicatorNr(popt,ANr,ADim,AIndex)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ADim
  CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  CHARACTER(LEN=256) :: cpy_AIndex
  ML_EXTERNAL optgetequindicatornr_
  INTEGER(KIND=4) optGetEquIndicatorNr_
  optGetEquIndicatorNr = optGetEquIndicatorNr_(val(popt), val(ANr) &
         , val(ADim), cpy_AIndex)
  CALL ConvStringPAS2F(cpy_AIndex, AIndex)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetVarIndicatorNr(popt,ANr,ADim,AIndex)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ADim
  CHARACTER(LEN=*), INTENT(OUT) :: AIndex
  CHARACTER(LEN=256) :: cpy_AIndex
  ML_EXTERNAL optgetvarindicatornr_
  INTEGER(KIND=4) optGetVarIndicatorNr_
  optGetVarIndicatorNr = optGetVarIndicatorNr_(val(popt), val(ANr) &
         , val(ADim), cpy_AIndex)
  CALL ConvStringPAS2F(cpy_AIndex, AIndex)
END FUNCTION

INTEGER(KIND=4) FUNCTION optIndicatorCount(popt,ANrErrors)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  ML_EXTERNAL optindicatorcount_
  INTEGER(KIND=4) optIndicatorCount_
  optIndicatorCount = optIndicatorCount_(val(popt), ANrErrors)
END FUNCTION

INTEGER(KIND=4) FUNCTION optDotOptCount(popt,ANrErrors)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(OUT) :: ANrErrors
  ML_EXTERNAL optdotoptcount_
  INTEGER(KIND=4) optDotOptCount_
  optDotOptCount = optDotOptCount_(val(popt), ANrErrors)
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetRefNr(popt,ANr,ARefNr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: ANr
  INTEGER(KIND=4), INTENT(IN) :: ARefNr
  ML_EXTERNAL optsetrefnr_
  INTEGER(KIND=4) optSetRefNr_
  optSetRefNr = optSetRefNr_(val(popt), val(ANr), val(ARefNr))
END FUNCTION

INTEGER(KIND=4) FUNCTION optSetRefNrStr(popt,AOpt,ARefNr)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AOpt
  CHARACTER(LEN=256) :: cpy_AOpt
  INTEGER(KIND=4), INTENT(IN) :: ARefNr
  ML_EXTERNAL optsetrefnrstr_
  INTEGER(KIND=4) optSetRefNrStr_
  CALL ConvStringF2PAS(AOpt, cpy_AOpt)
  optSetRefNrStr = optSetRefNrStr_(val(popt), cpy_AOpt, val(ARefNr))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetConstName(popt,cgroup,cindex,cname)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: cgroup
  INTEGER(KIND=4), INTENT(IN) :: cindex
  CHARACTER(LEN=*), INTENT(OUT) :: cname
  CHARACTER(LEN=256) :: cpy_cname
  ML_EXTERNAL optgetconstname_
  INTEGER(KIND=4) optGetConstName_
  optGetConstName = optGetConstName_(val(popt), val(cgroup), val(cindex) &
         , cpy_cname)
  CALL ConvStringPAS2F(cpy_cname, cname)
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetTypeName(popt,TNr,sTName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: TNr
  CHARACTER(LEN=*), INTENT(OUT) :: sTName
  CHARACTER(LEN=256) :: cpy_sTName
  ML_EXTERNAL optgettypename_
  INTEGER(KIND=4) optGetTypeName_
  optGetTypeName = optGetTypeName_(val(popt), val(TNr), cpy_sTName)
  CALL ConvStringPAS2F(cpy_sTName, sTName)
END FUNCTION

INTEGER(KIND=4) FUNCTION optLookUp(popt,AOpt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AOpt
  CHARACTER(LEN=256) :: cpy_AOpt
  ML_EXTERNAL optlookup_
  INTEGER(KIND=4) optLookUp_
  CALL ConvStringF2PAS(AOpt, cpy_AOpt)
  optLookUp = optLookUp_(val(popt), cpy_AOpt)
END FUNCTION

SUBROUTINE optReadFromPChar(popt,p)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN OUT) :: p
  CHARACTER(LEN=256) :: cpy_p
  ML_EXTERNAL optreadfrompchar_
  CALL ConvF2PChar(p, cpy_p)
  CALL optReadFromPChar_(val(popt), cpy_p)
  CALL ConvStringC2F(cpy_p, p)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optGetNameOpt(popt,ASVal,solver,opt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  CHARACTER(LEN=*), INTENT(OUT) :: solver
  CHARACTER(LEN=256) :: cpy_solver
  INTEGER(KIND=4), INTENT(OUT) :: opt
  ML_EXTERNAL optgetnameopt_
  INTEGER(KIND=4) optGetNameOpt_
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  optGetNameOpt = optGetNameOpt_(val(popt), cpy_ASVal, cpy_solver &
         , opt)
  CALL ConvStringPAS2F(cpy_solver, solver)
END FUNCTION

LOGICAL FUNCTION optGetDefinedStr(popt,AName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  ML_EXTERNAL optgetdefinedstr_
  INTEGER(KIND=4) optGetDefinedStr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optGetDefinedStr = optGetDefinedStr_(val(popt), cpy_AName) /= 0
END FUNCTION

INTEGER(KIND=4) FUNCTION optGetIntStr(popt,AName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  ML_EXTERNAL optgetintstr_
  INTEGER(KIND=4) optGetIntStr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optGetIntStr = optGetIntStr_(val(popt), cpy_AName)
END FUNCTION

REAL(KIND=8) FUNCTION optGetDblStr(popt,AName)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  ML_EXTERNAL optgetdblstr_
  REAL(KIND=8) optGetDblStr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  optGetDblStr = optGetDblStr_(val(popt), cpy_AName)
END FUNCTION

SUBROUTINE optSetIntStr(popt,AName,AIVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  INTEGER(KIND=4), INTENT(IN) :: AIVal
  ML_EXTERNAL optsetintstr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  CALL optSetIntStr_(val(popt), cpy_AName, val(AIVal))
END SUBROUTINE

SUBROUTINE optSetDblStr(popt,AName,ADVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  REAL(KIND=8), INTENT(IN) :: ADVal
  ML_EXTERNAL optsetdblstr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  CALL optSetDblStr_(val(popt), cpy_AName, val(ADVal))
END SUBROUTINE

SUBROUTINE optSetStrStr(popt,AName,ASVal)
  INTEGER(KIND=4), INTENT(IN) :: popt
  CHARACTER(LEN=*), INTENT(IN) :: AName
  CHARACTER(LEN=256) :: cpy_AName
  CHARACTER(LEN=*), INTENT(IN) :: ASVal
  CHARACTER(LEN=256) :: cpy_ASVal
  ML_EXTERNAL optsetstrstr_
  CALL ConvStringF2PAS(AName, cpy_AName)
  CALL ConvStringF2PAS(ASVal, cpy_ASVal)
  CALL optSetStrStr_(val(popt), cpy_AName, cpy_ASVal)
END SUBROUTINE

INTEGER(KIND=4) FUNCTION optCount(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optcount_
  INTEGER(KIND=4) optCount_
  optCount = optCount_(val(popt))
END FUNCTION

INTEGER(KIND=4) FUNCTION optMessageCount(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optmessagecount_
  INTEGER(KIND=4) optMessageCount_
  optMessageCount = optMessageCount_(val(popt))
END FUNCTION

INTEGER(KIND=4) FUNCTION optGroupCount(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optgroupcount_
  INTEGER(KIND=4) optGroupCount_
  optGroupCount = optGroupCount_(val(popt))
END FUNCTION

INTEGER(KIND=4) FUNCTION optRecentEnabled(popt)
  INTEGER(KIND=4), INTENT(IN) :: popt
  ML_EXTERNAL optrecentenabled_
  INTEGER(KIND=4) optRecentEnabled_
  optRecentEnabled = optRecentEnabled_(val(popt))
END FUNCTION

SUBROUTINE optRecentEnabledSet(popt,x)
  INTEGER(KIND=4), INTENT(IN) :: popt
  INTEGER(KIND=4), INTENT(IN) :: x
  ML_EXTERNAL optrecentenabledset_
  CALL optRecentEnabledSet_(val(popt), val(x))
END SUBROUTINE
